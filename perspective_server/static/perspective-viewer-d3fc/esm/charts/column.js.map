{"version":3,"sources":["../../../src/js/charts/column.js"],"names":["fc","axisFactory","chartSvgFactory","domainMatchOrigins","axisSplitter","dataBlankFunction","groupedBlankFunction","AXIS_TYPES","barSeries","seriesColors","groupAndStackData","colorLegend","filterData","withGridLines","hardLimitZeroPadding","zoomableChart","columnChart","container","settings","data","color","legend","scale","bars","orient","series","seriesSvgMulti","mapping","index","map","xAxis","excludeType","linear","settingName","valueName","yAxisFactory","ordinal","include","paddingStrategy","blankFunction","mainValues","length","splitter","yAxis1","plotSeries","haveSplit","chart","plotArea","xPaddingInner","xPaddingOuter","align","yNice","zoomChart","xScale","yAxis2","altData","domain","yDomain","altAxis","datum","call","plugin","type","name","max_cells","max_columns"],"mappings":"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","sourcesContent":["/******************************************************************************\r\n *\r\n * Copyright (c) 2017, the Perspective Authors.\r\n *\r\n * This file is part of the Perspective library, distributed under the terms of\r\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\r\n *\r\n */\r\nimport * as fc from \"d3fc\";\r\nimport {axisFactory} from \"../axis/axisFactory\";\r\nimport {chartSvgFactory} from \"../axis/chartFactory\";\r\nimport domainMatchOrigins from \"../axis/domainMatchOrigins\";\r\nimport {axisSplitter, dataBlankFunction, groupedBlankFunction} from \"../axis/axisSplitter\";\r\nimport {AXIS_TYPES} from \"../axis/axisType\";\r\nimport {barSeries} from \"../series/barSeries\";\r\nimport {seriesColors} from \"../series/seriesColors\";\r\nimport {groupAndStackData} from \"../data/groupData\";\r\nimport {colorLegend} from \"../legend/legend\";\r\nimport {filterData} from \"../legend/filter\";\r\nimport withGridLines from \"../gridlines/gridlines\";\r\nimport {hardLimitZeroPadding} from \"../d3fc/padding/hardLimitZero\";\r\nimport zoomableChart from \"../zoom/zoomableChart\";\r\n\r\nfunction columnChart(container, settings) {\r\n    const data = groupAndStackData(settings, filterData(settings));\r\n    const color = seriesColors(settings);\r\n\r\n    const legend = colorLegend()\r\n        .settings(settings)\r\n        .scale(color);\r\n\r\n    const bars = barSeries(settings, color).orient(\"vertical\");\r\n    const series = fc\r\n        .seriesSvgMulti()\r\n        .mapping((data, index) => data[index])\r\n        .series(data.map(() => bars));\r\n\r\n    const xAxis = axisFactory(settings)\r\n        .excludeType(AXIS_TYPES.linear)\r\n        .settingName(\"crossValues\")\r\n        .valueName(\"crossValue\")(data);\r\n    const yAxisFactory = axisFactory(settings)\r\n        .settingName(\"mainValues\")\r\n        .valueName(\"mainValue\")\r\n        .excludeType(AXIS_TYPES.ordinal)\r\n        .orient(\"vertical\")\r\n        .include([0])\r\n        .paddingStrategy(hardLimitZeroPadding());\r\n\r\n    // Check whether we've split some values into a second y-axis\r\n    const blankFunction = settings.mainValues.length > 1 ? groupedBlankFunction : dataBlankFunction;\r\n    const splitter = axisSplitter(settings, data, blankFunction).color(color);\r\n\r\n    const yAxis1 = yAxisFactory(splitter.data());\r\n\r\n    // No grid lines if splitting y-axis\r\n    const plotSeries = splitter.haveSplit() ? series : withGridLines(series, settings).orient(\"vertical\");\r\n\r\n    const chart = chartSvgFactory(xAxis, yAxis1)\r\n        .axisSplitter(splitter)\r\n        .plotArea(plotSeries);\r\n\r\n    if (chart.xPaddingInner) {\r\n        chart.xPaddingInner(0.5);\r\n        chart.xPaddingOuter(0.25);\r\n        bars.align(\"left\");\r\n    }\r\n    chart.yNice && chart.yNice();\r\n\r\n    const zoomChart = zoomableChart()\r\n        .chart(chart)\r\n        .settings(settings)\r\n        .xScale(xAxis.scale);\r\n\r\n    if (splitter.haveSplit()) {\r\n        // Create the y-axis data for the alt-axis\r\n        const yAxis2 = yAxisFactory(splitter.altData());\r\n\r\n        domainMatchOrigins(yAxis1.domain, yAxis2.domain);\r\n        chart.yDomain(yAxis1.domain).altAxis(yAxis2);\r\n    }\r\n\r\n    // render\r\n    container.datum(splitter.data()).call(zoomChart);\r\n    container.call(legend);\r\n}\r\ncolumnChart.plugin = {\r\n    type: \"d3_y_bar\",\r\n    name: \"Y Bar Chart\",\r\n    max_cells: 1000,\r\n    max_columns: 50\r\n};\r\n\r\nexport default columnChart;\r\n"],"file":"column.js"}