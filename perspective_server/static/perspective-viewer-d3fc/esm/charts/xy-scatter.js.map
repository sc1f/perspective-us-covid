{"version":3,"sources":["../../../src/js/charts/xy-scatter.js"],"names":["fc","axisFactory","chartCanvasFactory","pointSeriesCanvas","symbolTypeFromGroups","pointData","seriesColorsFromGroups","seriesLinearRange","seriesColorRange","symbolLegend","colorRangeLegend","filterDataByGroup","withGridLines","hardLimitZeroPadding","zoomableChart","nearbyTip","xyScatter","container","settings","data","symbols","useGroupColors","realValues","length","color","legend","scale","size","range","series","seriesCanvasMulti","mapping","index","map","key","axisDefault","settingName","paddingStrategy","pad","xAxis","settingValue","mainValues","name","valueName","yAxis","orient","chart","xLabel","yLabel","plotArea","canvas","xNice","yNice","zoomChart","xScale","yScale","toolTip","xValueName","yValueName","datum","call","plugin","type","max_cells","max_columns","initial","count","names","selectMode"],"mappings":"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","sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\nimport * as fc from \"d3fc\";\nimport {axisFactory} from \"../axis/axisFactory\";\nimport {chartCanvasFactory} from \"../axis/chartFactory\";\nimport {pointSeriesCanvas, symbolTypeFromGroups} from \"../series/pointSeriesCanvas\";\nimport {pointData} from \"../data/pointData\";\nimport {seriesColorsFromGroups} from \"../series/seriesColors\";\nimport {seriesLinearRange, seriesColorRange} from \"../series/seriesRange\";\nimport {symbolLegend} from \"../legend/legend\";\nimport {colorRangeLegend} from \"../legend/colorRangeLegend\";\nimport {filterDataByGroup} from \"../legend/filter\";\nimport withGridLines from \"../gridlines/gridlines\";\nimport {hardLimitZeroPadding} from \"../d3fc/padding/hardLimitZero\";\nimport zoomableChart from \"../zoom/zoomableChart\";\nimport nearbyTip from \"../tooltip/nearbyTip\";\n\nfunction xyScatter(container, settings) {\n    const data = pointData(settings, filterDataByGroup(settings));\n    const symbols = symbolTypeFromGroups(settings);\n    const useGroupColors = settings.realValues.length <= 2 || settings.realValues[2] === null;\n    let color = null;\n    let legend = null;\n\n    if (useGroupColors) {\n        color = seriesColorsFromGroups(settings);\n\n        legend = symbolLegend()\n            .settings(settings)\n            .scale(symbols)\n            .color(useGroupColors ? color : null);\n    } else {\n        color = seriesColorRange(settings, data, \"colorValue\");\n        legend = colorRangeLegend().scale(color);\n    }\n\n    const size = settings.realValues[3] ? seriesLinearRange(settings, data, \"size\").range([10, 10000]) : null;\n\n    const series = fc\n        .seriesCanvasMulti()\n        .mapping((data, index) => data[index])\n        .series(data.map(series => pointSeriesCanvas(settings, series.key, size, color, symbols)));\n\n    const axisDefault = () =>\n        axisFactory(settings)\n            .settingName(\"mainValues\")\n            .paddingStrategy(hardLimitZeroPadding())\n            .pad([0.1, 0.1]);\n\n    const xAxis = axisDefault()\n        .settingValue(settings.mainValues[0].name)\n        .valueName(\"x\")(data);\n    const yAxis = axisDefault()\n        .orient(\"vertical\")\n        .settingValue(settings.mainValues[1].name)\n        .valueName(\"y\")(data);\n\n    const chart = chartCanvasFactory(xAxis, yAxis)\n        .xLabel(settings.mainValues[0].name)\n        .yLabel(settings.mainValues[1].name)\n        .plotArea(withGridLines(series, settings).canvas(true));\n\n    chart.xNice && chart.xNice();\n    chart.yNice && chart.yNice();\n\n    const zoomChart = zoomableChart()\n        .chart(chart)\n        .settings(settings)\n        .xScale(xAxis.scale)\n        .yScale(yAxis.scale)\n        .canvas(true);\n\n    const toolTip = nearbyTip()\n        .settings(settings)\n        .canvas(true)\n        .xScale(xAxis.scale)\n        .xValueName(\"x\")\n        .yValueName(\"y\")\n        .yScale(yAxis.scale)\n        .color(useGroupColors && color)\n        .size(size)\n        .data(data);\n\n    // render\n    container.datum(data).call(zoomChart);\n    container.call(toolTip);\n    if (legend) container.call(legend);\n}\nxyScatter.plugin = {\n    type: \"d3_xy_scatter\",\n    name: \"X/Y Scatter Chart\",\n    max_cells: 50000,\n    max_columns: 50,\n    initial: {\n        type: \"number\",\n        count: 2,\n        names: [\"X Axis\", \"Y Axis\", \"Color\", \"Size\", \"Tooltip\"]\n    },\n    selectMode: \"toggle\"\n};\n\nexport default xyScatter;\n"],"file":"xy-scatter.js"}