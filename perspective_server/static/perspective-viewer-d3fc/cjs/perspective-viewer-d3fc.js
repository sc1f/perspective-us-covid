!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("d3"),require("d3fc"),require("core-js/modules/es.array.iterator"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.string.split"),require("d3-array"),require("core-js/modules/es.string.includes"),require("core-js/modules/es.array.sort"),require("d3-svg-legend"),require("core-js/modules/es.array.reverse"),require("@finos/perspective/dist/esm/config"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.promise"),require("core-js/modules/es.object.assign"),require("@finos/perspective-viewer/dist/esm/utils.js"),require("gradient-parser"),require("@finos/perspective-viewer/dist/esm/utils"),require("core-js/modules/es.string.replace")):"function"==typeof define&&define.amd?define(["d3","d3fc","core-js/modules/es.array.iterator","core-js/modules/web.dom-collections.iterator","core-js/modules/es.string.split","d3-array","core-js/modules/es.string.includes","core-js/modules/es.array.sort","d3-svg-legend","core-js/modules/es.array.reverse","@finos/perspective/dist/esm/config","core-js/modules/es.symbol.description","core-js/modules/es.promise","core-js/modules/es.object.assign","@finos/perspective-viewer/dist/esm/utils.js","gradient-parser","@finos/perspective-viewer/dist/esm/utils","core-js/modules/es.string.replace"],t):"object"==typeof exports?exports["perspective-view-d3fc"]=t(require("d3"),require("d3fc"),require("core-js/modules/es.array.iterator"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.string.split"),require("d3-array"),require("core-js/modules/es.string.includes"),require("core-js/modules/es.array.sort"),require("d3-svg-legend"),require("core-js/modules/es.array.reverse"),require("@finos/perspective/dist/esm/config"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.promise"),require("core-js/modules/es.object.assign"),require("@finos/perspective-viewer/dist/esm/utils.js"),require("gradient-parser"),require("@finos/perspective-viewer/dist/esm/utils"),require("core-js/modules/es.string.replace")):e["perspective-view-d3fc"]=t(e.d3,e.d3fc,e["core-js/modules/es.array.iterator"],e["core-js/modules/web.dom-collections.iterator"],e["core-js/modules/es.string.split"],e["d3-array"],e["core-js/modules/es.string.includes"],e["core-js/modules/es.array.sort"],e["d3-svg-legend"],e["core-js/modules/es.array.reverse"],e["@finos/perspective/dist/esm/config"],e["core-js/modules/es.symbol.description"],e["core-js/modules/es.promise"],e["core-js/modules/es.object.assign"],e["@finos/perspective-viewer/dist/esm/utils.js"],e["gradient-parser"],e["@finos/perspective-viewer/dist/esm/utils"],e["core-js/modules/es.string.replace"])}(window,(function(e,t,n,a,r,o,l,i,s,c,u,d,h,p,g,m,f,y){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t){e.exports=l},function(e,t){e.exports=i},function(e,t){e.exports=s},function(e,t){e.exports=c},function(e,t){e.exports=u},function(e,t){e.exports=d},function(e,t){e.exports=h},function(e,t){e.exports=p},function(e,t){e.exports=g},function(e,t){e.exports='<ul id="tooltip-values"></ul>'},function(e,t){e.exports='<span id="up-arrow">&#9650;</span>\n<span id="page-text"></span>\n<span id="down-arrow">&#9660;</span>'},function(e,t){e.exports='<button id="zoom-reset">Reset zoom</button>\n<button id="one-year">1 Year</button>\n<button id="six-months">6 Months</button>\n<button id="one-month">1 Month</button>'},function(e,t){e.exports='<button id="goto-parent">Goto parent</button>'},function(e,t,n){(e.exports=n(26)(!1)).push([e.i,':host .chart{position:absolute;box-sizing:border-box;left:0;top:0;width:100%;height:100%;padding:15px;overflow:hidden}:host .chart.d3_heatmap d3fc-group.cartesian-chart,:host .chart.d3_treemap d3fc-group.cartesian-chart{grid-template-columns:minmax(0,max-content) auto 1fr auto minmax(0,max-content);grid-template-rows:minmax(0,max-content) auto 1fr auto minmax(0,max-content)}:host .chart .chart-label{display:none}:host .chart.d3_heatmap{padding-right:120px}:host .chart.d3_sunburst{padding:0}:host .chart.d3_sunburst .inner-container{width:100%;height:100%;display:inline-grid;padding:0;margin:0;overflow-x:hidden;overflow-y:auto}:host .chart.d3_sunburst .inner-container div{overflow:hidden}:host .chart.d3_sunburst .inner-container svg{width:100%;height:100%;transform:translate(0,-27px)}:host .chart.d3_sunburst .inner-container path{fill:var(--d3fc-series,rgba(31,119,180,.5))}:host .chart.d3_sunburst .inner-container text.parent,:host .chart.d3_sunburst .inner-container text.segment{text-anchor:middle;user-select:none;pointer-events:none;fill:var(--d3fc-treedata--labels,#333)}:host .chart.d3_sunburst .inner-container div.title-container{margin-top:5px}:host .chart.d3_treemap{padding-right:120px}:host .chart.d3_treemap .treemap-container{position:relative}:host .chart.d3_treemap .inner-container{width:100%;height:100%;display:inline-grid;padding:0;margin:0;overflow-x:hidden;overflow-y:auto}:host .chart.d3_treemap .inner-container div{overflow:hidden}:host .chart.d3_treemap .inner-container svg{width:100%;height:100%}:host .chart.d3_treemap .inner-container .treerect{stroke:var(--d3fc-treedata-axis--lines,var(--d3fc-axis--lines,#fff));fill:var(--d3fc-series,rgba(31,119,180,.5))}:host .chart.d3_treemap .inner-container .treerect:hover{cursor:pointer;stroke:var(--d3fc-treedata--hover-highlight,#000);stroke-opacity:1}:host .chart.d3_treemap .inner-container .rootnode{opacity:0;pointer-events:none;z-index:0}:host .chart.d3_treemap .inner-container .branchnode{opacity:0}:host .chart.d3_treemap .inner-container .branchnode:hover{fill-opacity:.1;opacity:1;fill:var(--d3fc-treedata--hover-highlight,#000)}:host .chart.d3_treemap .inner-container .leafnode{fill-opacity:.8}:host .chart.d3_treemap .inner-container .leafnode:hover{fill-opacity:.5}:host .chart.d3_treemap .inner-container #hidden{opacity:0;pointer-events:none;z-index:0}:host .chart.d3_treemap .inner-container .top{font-size:19px;font-weight:700;z-index:5;pointer-events:none}:host .chart.d3_treemap .inner-container .mid{font-size:10px;font-weight:700;opacity:.7;z-index:4}:host .chart.d3_treemap .inner-container .lower{font-size:0;font-weight:700;opacity:0;z-index:4}:host .chart.d3_treemap .inner-container text{fill:var(--d3fc-treedata--labels,#333)}:host .chart.d3_treemap .inner-container text.title{dominant-baseline:hanging}:host .chart.d3_treemap .inner-container .parent-controls{position:absolute;top:15px;right:auto;left:30px;width:auto;z-index:4;transition:box-shadow 1s}:host .chart.d3_treemap .inner-container .parent-controls:hover{box-shadow:2px 2px 6px #000;transition:box-shadow .2s}:host .chart .x-label{height:1.2em!important}:host .chart d3fc-canvas.plot-area{display:none}:host .chart.d3_candlestick d3fc-canvas.plot-area,:host .chart.d3_ohlc d3fc-canvas.plot-area,:host .chart.d3_xy_scatter d3fc-canvas.plot-area{display:block}:host .chart .x-axis text,:host .chart .y-axis text{fill:var(--d3fc-axis--ticks,#505050);font-size:11px}:host .chart .x-axis path,:host .chart .y-axis path{stroke:var(--d3fc-axis--lines,#b4d2e1)}:host .chart .splitter-label{display:inline-block;margin:0 10px;cursor:pointer}:host .chart .splitter-label::after{margin-left:5px;color:var(--d3fc-axis--lines,#b4d2e1)}:host .chart .splitter-label:hover::after{color:var(--d3fc-axis--ticks,#505050)}:host .chart .splitter-label.disabled{cursor:default}:host .chart .splitter-label.disabled::after{color:rgba(80,80,80,.3)}:host .chart .y-label-container .splitter-label::after{content:"\\1F847"}:host .chart .y2-label-container .splitter-label::after{content:"\\1F845"}:host .chart.d3_x_bar .x-axis path,:host .chart.d3_xy_scatter .x-axis path,:host .chart.d3_xy_scatter .y-axis path,:host .chart.d3_y_area .y-axis path,:host .chart.d3_y_bar .y-axis path,:host .chart.d3_y_line .y-axis path,:host .chart.d3_y_scatter .y-axis path{visibility:hidden}:host .chart .y-label{white-space:nowrap}:host .chart .nearbyTip{fill:var(--d3fc-series,rgba(31,119,180,.5))}:host .chart .series{fill:var(--d3fc-series,rgba(31,119,180,.5))}:host .chart .series-1{fill:var(--d3fc-series-1,#0366d6)}:host .chart .series-2{fill:var(--d3fc-series-2,#ff7f0e)}:host .chart .series-3{fill:var(--d3fc-series-3,#2ca02c)}:host .chart .series-4{fill:var(--d3fc-series-4,#d62728)}:host .chart .series-5{fill:var(--d3fc-series-5,#9467bd)}:host .chart .series-6{fill:var(--d3fc-series-6,#8c564b)}:host .chart .series-7{fill:var(--d3fc-series-7,#e377c2)}:host .chart .series-8{fill:var(--d3fc-series-8,#7f7f7f)}:host .chart .series-9{fill:var(--d3fc-series-9,#bcbd22)}:host .chart .series-10{fill:var(--d3fc-series-10,#17becf)}:host .disabled{filter:grayscale(100%)}:host #dragHandles{position:absolute;top:0;right:0;left:auto;pointer-events:none}:host #dragHandles rect{pointer-events:all}:host .label rect{fill:none}:host .legend-container{position:absolute;top:15px;right:15px;left:auto;width:150px;height:280px}:host .legend-container.legend-color{width:90px;height:150px}:host .legend-container[borderbox-on-hover=true]{transition:box-shadow 1s}:host .legend-container[borderbox-on-hover=true]:hover{box-shadow:0 2px 5px rgba(0,0,0,.2);transition:box-shadow .2s}:host .legend-container .legend{font-size:8pt;width:100%}:host .legend-container .legend .cell{cursor:pointer}:host .legend-container .legend .cell path{fill:var(--d3fc-series,rgba(31,119,180,.5));stroke:var(--d3fc-series,#1f77b4)}:host .legend-container .legend .cell.hidden path{fill:rgba(204,204,204,.5);stroke:#ccc}:host .legend-container .legend .cell.hidden circle{fill:#ccc!important}:host .legend-container text{fill:var(--d3fc-legend--text,#333)}:host .legend-container .label:hover{fill:#22a0ce}:host .legend-container #legend-axis path{stroke:var(--d3fc-legend--text,#333)}:host .legend-container .legend-controls{margin-left:12px}:host .legend-container .legend-controls #down-arrow,:host .legend-container .legend-controls #up-arrow{cursor:pointer;color:#1f77b4}:host .legend-container .legend-controls #down-arrow.disabled,:host .legend-container .legend-controls #up-arrow.disabled{cursor:default;color:#333}:host .d3_heatmap .legend-container.legend-color{height:200px}:host .d3_treemap .legend-container.legend-color{height:200px}:host .zoom-controls{position:absolute;top:10px;left:0;width:100%;text-align:center}:host .zoom-controls button{-webkit-appearance:none;background:#f7f7f7;border:1px solid #ccc;padding:10px;opacity:.5;cursor:pointer}:host .zoom-controls button:hover{background:#e6e6e6}:host .parent-controls{position:absolute;top:30px;right:145px;width:100%;text-align:right}:host .parent-controls button{-webkit-appearance:none;background:#f7f7f7;border:1px solid #ccc;padding:10px;opacity:.5;cursor:pointer}:host .parent-controls button:hover{background:#e6e6e6}:host div.tooltip{position:absolute;text-align:left;font-size:10pt;white-space:nowrap;padding:.5em;background:var(--d3fc-tooltip--background,#fff);color:var(--d3fc-tooltip--color,#000);border:1px solid #777;border-radius:2px;pointer-events:none}:host div.tooltip ul{margin:0;padding:0;list-style-type:none}',""])},function(e,t){e.exports='<template id="perspective-d3fc-chart">\r\n    <div id="container" class="chart">\r\n    </div>\r\n</template>'},function(e,t){e.exports=m},function(e,t){e.exports=f},function(e,t){e.exports=y},function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector)},function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null})},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=(l=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(l))))+" */"),o=a.sources.map((function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"}));return[n].concat(o).concat([r]).join("\n")}var l;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(a[o]=!0)}for(r=0;r<e.length;r++){var l=e[r];"number"==typeof l[0]&&a[l[0]]||(n&&!l[2]?l[2]=n:n&&(l[2]="("+l[2]+") and ("+n+")"),t.push(l))}},t}},function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"scale",(function(){return m})),n.d(a,"domain",(function(){return f})),n.d(a,"labelFunction",(function(){return y}));var r={};n.r(r),n.d(r,"scale",(function(){return O})),n.d(r,"domain",(function(){return V})),n.d(r,"labelFunction",(function(){return _})),n.d(r,"tickFormatFunction",(function(){return j}));var o={};n.r(o),n.d(o,"scale",(function(){return S})),n.d(o,"domain",(function(){return k})),n.d(o,"labelFunction",(function(){return z}));var l={};n.r(l),n.d(l,"scale",(function(){return R})),n.d(l,"domain",(function(){return D})),n.d(l,"labelFunction",(function(){return L})),n.d(l,"component",(function(){return B}));n(11),n(2),n(12),n(3);var i=n(14),s=n(1);n(6);const c={none:"none",ordinal:"ordinal",time:"time",linear:"linear"},u=e=>{let t="crossValues",n=null,a=null;const r=()=>{const r=a=>{const r=n?e[t].filter(e=>n==e.name):e[t];return!("crossValues"==t&&r.length>1)&&r.some(e=>a.includes(e.type))};return 0===e[t].length?c.none:a!=c.time&&r(["datetime","date"])?c.time:a!=c.linear&&r(["integer","float"])?c.linear:a==c.ordinal?c.linear:c.ordinal};return r.settingName=(...e)=>e.length?(t=e[0],r):t,r.settingValue=(...e)=>e.length?(n=e[0],r):n,r.excludeType=(...e)=>e.length?(a=e[0],r):a,r};n(9);var d=n(0);const h=e=>{const t=e=>(t,n)=>void 0===t?n:void 0===n?t:e(t,n);return e.reduce((e,n)=>[t(Math.min)(e[0],n[0]),t(Math.max)(e[1],n[1])],[void 0,void 0])},p=e=>Array.isArray(e)?[].concat(...e.map(p)):[e];var g=e=>{const t=t=>e(t);return Object(s.rebindAll)(t,e),t.bandwidth=(...n)=>n.length?(e.bandwidth(...n),t):Math.max(e.bandwidth(),1),t};const m=()=>(e=>{const t=t=>e(t);return Object(s.rebindAll)(t,e),t.ticks=function(){return[]},t})(g(d.scaleBand())),f=()=>{let e=["crossValue"],t="horizontal";const n=t=>{const n=p(t);return a([...new Set(n.map(t=>t[e[0]]))])},a=e=>"vertical"==t?e.reverse():e;return n.valueName=(...t)=>t.length?(e=[t[0]],n):e[0],n.valueNames=(...t)=>t.length?(e=t[0],n):e,n.orient=(...e)=>e.length?(t=e[0],n):t,n},y=e=>t=>t[e].join("|");n(7);var b=n(5);const x=()=>{let e=[0,0],t="percent";const n=n=>{switch(t){case"domain":n[0]-=e[0],n[1]+=e[1];break;case"percent":{let t=n[1]-n[0];n[0]-=e[0]*t,n[1]+=e[1]*t;break}default:throw new Error("Unknown padUnit: "+t)}return n};return n.pad=function(){return arguments.length?(e=arguments.length<=0?void 0:arguments[0],n):e},n.padUnit=function(){return arguments.length?(t=arguments.length<=0?void 0:arguments[0],n):t},n};let v=function(e){if(Array.isArray(e)){let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n];return t}return Array.from(e)};var w=e=>Math.abs(e)>=1e7?d.format(".3s")(e):Number.isInteger(e)?d.format(",.0f")(e):d.format(",.2f")(e);const O=()=>d.scaleLinear(),V=()=>{const e=function(){let e=[function(e){return e}],t=null,n=[],a=x();const r=function(r){let o=new Array(r.length),l=!0,i=!1,s=void 0,c=e[Symbol.iterator]();try{for(let e;!(l=(e=c.next()).done);l=!0){let t=e.value;for(let e=0;e<r.length;e++){let n=t(r[e],e);Array.isArray(n)?o.push.apply(o,v(n)):o.push(n)}}}catch(e){i=!0,s=e}finally{try{!l&&c.return&&c.return()}finally{if(i)throw s}}let u=[b.min(o),b.max(o)];if(u[0]=null==u[0]?b.min(n):b.min([u[0]].concat(v(n))),u[1]=null==u[1]?b.max(n):b.max([u[1]].concat(v(n))),null!=t){let e=Math.max(Math.abs(u[1]-t),Math.abs(u[0]-t));u[0]=t-e,u[1]=t+e}return a(u)};return r.accessors=function(){return arguments.length?(e=arguments.length<=0?void 0:arguments[0],r):e},r.pad=function(){return arguments.length?(a.pad(arguments.length<=0?void 0:arguments[0]),r):a.pad},r.padUnit=function(){return arguments.length?(a.padUnit(arguments.length<=0?void 0:arguments[0]),r):a.padUnit},r.include=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],r):n},r.symmetricalAbout=function(){return arguments.length?(t=arguments.length<=0?void 0:arguments[0],r):t},r.paddingStrategy=function(){return arguments.length?(a=arguments.length<=0?void 0:arguments[0],r):a},r}().pad([0,.1]).padUnit("percent");let t=["crossValue"];const n=n=>(e.accessors(t.map(e=>t=>parseFloat(t[e]))),a(p(n)));s.rebindAll(n,e);const a=n=>{if("domain"==e.padUnit()){const a=(e=>{const n=t.map(t=>e.map(e=>e[t]).sort((e,t)=>e-t).filter((e,t,n)=>0===t||e!==n[t-1]).reduce((e,t,n,a)=>0===n||e<=t-a[n-1]?e:Math.abs(t-a[n-1])));return Math.min(...n)})(n);return e.pad([a/2,a/2])(n)}return e(n)};return n.valueName=(...e)=>e.length?(t=[e[0]],n):t[0],n.valueNames=(...e)=>e.length?(t=e[0],n):t,n},_=e=>t=>t[e][0],j=w,S=()=>d.scaleTime(),k=()=>{const e=s.extentTime();let t=["crossValue"];const n=n=>(e.accessors(t.map(e=>t=>new Date(t[e]))),a(p(n)));s.rebindAll(n,e,s.exclude("include","paddingStrategy"));const a=n=>{const a=(e=>{const n=t.map(t=>e.map(e=>new Date(e[t]).getTime()).sort((e,t)=>e-t).filter((e,t,n)=>0===t||e!==n[t-1]).reduce((e,t,n,a)=>0===n||e<=t-a[n-1]?e:Math.abs(t-a[n-1])));return Math.min(...n)})(n);return e.padUnit("domain").pad([a/2,a/2])(n)};return n.valueName=(...e)=>e.length?(t=[e[0]],n):t[0],n.valueNames=(...e)=>e.length?(t=e[0],n):t,n},z=e=>t=>new Date(t[e][0]);n(4);const P=(e,t,n)=>{let a=6,r=6,o=((...e)=>{const t={},n=e=>{for(const n of Object.keys(t))e[n](t[n]);return e};for(const a of e)n[a]=(...e)=>e.length?(t[a]=e[0],n):t[a];return n})("tickFormat","ticks","tickArguments","tickValues","tickPadding"),l=()=>{},i=null;const c=Object(s.dataJoin)("g","group"),u=Object(s.dataJoin)("path","domain"),h=(e,t)=>p()?"translate(".concat(t,", ").concat(e,")"):"translate(".concat(e,", ").concat(t,")"),p=()=>"left"===e||"right"===e,g=s=>{i?(s.selection&&(c.transition(s),u.transition(s)),s.each((s,g,f)=>{const y=f[g],b=Object(d.select)(y),x="bottom"===e||"right"===e?1:-1,v=n.range(),w=(e=>p()?e.map(e=>[e[1],e[0]]):e)([[v[0],x*a],[v[0],0],[v[1],0],[v[1],x*a]]);u(b,[s]).attr("d",Object(d.line)()(w)).attr("stroke","#000").attr("fill","none");const O=c(b,i),V=e=>Array.isArray(r)?r[e]:r,_=e=>{let t=0;for(let n=0;n<e;n++)t+=V(n);return t};O.attr("transform",(e,t)=>h(0,x*_(t))).each((e,a,r)=>{const i=Object(d.select)(r[a]),s=m(n,e);o(t(s)).decorate((e,t)=>l(e,t,a)).tickSizeInner(V(a)).tickOffset(e=>s.step(e)/2)(i),i.select("path.domain").attr("visibility","hidden")}),O.exit().attr("transform",(e,t)=>h(0,x*_(t)))})):o(t(n).decorate(l))(s)},m=(e,t)=>{function n(t){const n=t.domain;return n.reduce((t,n)=>t+e(n),0)/n.length}return n.ticks=()=>t,n.tickFormat=()=>e=>e.text,n.copy=()=>m(e,t),n.step=t=>t.domain.length*e.step(),Object(s.rebindAll)(n,e,Object(s.exclude)("ticks","step","copy")),n};return g.tickSize=(...e)=>e.length?(r=a=Number(e[0]),g):r,g.tickSizeInner=(...e)=>e.length?(r=Array.isArray(e[0])?e[0]:Number(e[0]),g):r,g.tickSizeOuter=(...e)=>e.length?(a=Number(e[0]),g):a,g.decorate=(...e)=>e.length?(l=e[0],g):l,g.groups=(...e)=>e.length?(i=e[0],g):i,Object(s.rebindAll)(g,o),g},A=e=>P("top",s.axisOrdinalTop,e),N=e=>P("bottom",s.axisOrdinalBottom,e),C=e=>P("left",s.axisOrdinalLeft,e),M=e=>P("right",s.axisOrdinalRight,e);function E(e){return e.getRootNode().host}function T(e){return e.closest("#container.chart")}const R=()=>g(d.scaleBand()).padding(.5),D=()=>{let e=["crossValue"],t="horizontal";const n=t=>{const n=p(t);return a([...new Set(n.map(t=>t[e[0]]))])},a=e=>"vertical"==t?e.reverse():e;return n.valueName=(...t)=>t.length?(e=[t[0]],n):e[0],n.valueNames=(...t)=>t.length?(e=t[0],n):e,n.orient=(...e)=>e.length?(t=e[0],n):t,n},L=e=>t=>t[e].join("|"),B=e=>{let t="horizontal",n="crossValues",a=null;const r=()=>{const r=e[n].length>1,s=l(a),u=s.map(i),d=r?u.map(e=>e.size):u[0].size,p=u.reduce((e,t)=>e+t.size,0),g=e=>n=>{const a=e(n);return r&&a.groups(s).tickSizeInner(d).tickSizeOuter(p),"horizontal"!==t&&a.tickPadding(10),a},m=o(r);return{bottom:g(m.bottom),left:g(m.left),right:g(m.right),top:g(m.top),size:"".concat(p+10,"px"),decorate:(e,n,a)=>{const r=u[a].rotation;"horizontal"===t&&h(e,r),c(e,r)}}},o=e=>e?{bottom:N,left:C,top:A,right:M}:{bottom:s.axisOrdinalBottom,left:s.axisOrdinalLeft,top:s.axisOrdinalTop,right:s.axisOrdinalRight},l=e=>{const t=[];return e.forEach(e=>{(e&&e.split?e.split("|"):[e]).forEach((n,a)=>{for(;t.length<=a;)t.push([]);const r=t[a];r.length>0&&r[r.length-1].text===n?r[r.length-1].domain.push(e):r.push({text:n,domain:[e]})})}),t.reverse()},i=n=>{const a=e.size.width,r=Math.max(...n.map(e=>e.text?e.text.length:0));return"horizontal"===t?n&&16*n.length>a-100?{size:5*r+10,rotation:90}:n&&n.length*(6*r+10)>a-100?{size:3*r+20,rotation:45}:{size:25,rotation:0}:{size:5*r+10,rotation:0}},c=(e,n)=>{const a=n?(e,t)=>e.x+e.width+14>t.x+t.width:(e,t)=>e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height,r="horizontal"==t?u(e):null,o=[];e.each((e,t,n)=>{const l=d.select(n[t]),i=(e=>{const t=-1!==e.indexOf(",")?",":" ",n=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(t).map(e=>parseInt(e));for(;n.length<2;)n.push(0);return n})(l.attr("transform")),s=l.node().getBBox(),c={x:s.x+i[0],y:s.y+i[1],width:s.width,height:s.height},u=o.some(e=>a(e,c))||r&&!((e,t)=>e.x>=t.x&&e.x+e.width<=t.x+t.width&&e.y>=t.y&&e.y+e.height<=t.y+t.height)(c,r);l.attr("visibility",u?"hidden":""),u||o.push(c)})},u=e=>{const t=T(e.node());if(null===t)return;const n=t.querySelector(".cartesian-chart"),a=n.querySelector(".x-axis"),r=n.getBoundingClientRect(),o=a.getBoundingClientRect();return{x:r.left-o.left,width:r.width,y:r.top-o.top,height:r.height}},h=(e,t)=>{const n=(e=>e?"rotate(-".concat(e,e<60?" 5 5)":" 3 7)"):"translate(0, 8)")(t),a=t?"end":"";e.each((e,t,r)=>{d.select(r[t]).select("text").attr("transform",n).style("text-anchor",a)})};return r.orient=(...e)=>e.length?(t=e[0],r):t,r.settingName=(...e)=>e.length?(n=e[0],r):n,r.domain=(...e)=>e.length?(a=e[0],r):a,r},q={none:a,ordinal:l,time:o,linear:r},F=e=>{let t=null,n="horizontal",a="crossValues",r=null,o=["crossValue"];const l=["include","paddingStrategy","pad"],i={},c=s=>{const c=u(e).excludeType(t).settingName(a).settingValue(r)(),p=q[c],g=p.domain().valueNames(o);l.forEach(e=>{i[e]&&g[e]&&g[e](i[e])}),g.orient&&g.orient(n);const m=g(s),f=p.component?d(p,m,s):h();return{scale:p.scale(),domain:m,domainFunction:g,labelFunction:p.labelFunction,component:{bottom:f.bottom,left:f.left,top:f.top,right:f.right},size:f.size,decorate:f.decorate,label:e[a].map(e=>e.name).join(", "),tickFormatFunction:p.tickFormatFunction}},d=(t,r,o)=>t.component(e).orient(n).settingName(a).domain(r)(o),h=()=>({bottom:s.axisBottom,left:s.axisLeft,top:s.axisTop,right:s.axisRight,decorate:()=>{}});return c.excludeType=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.settingName=(...e)=>e.length?(a=e[0],c):a,c.settingValue=(...e)=>e.length?(r=e[0],c):r,c.valueName=(...e)=>e.length?(o=[e[0]],c):o[0],c.valueNames=(...e)=>e.length?(o=e[0],c):o,l.forEach(e=>{c[e]=(...t)=>t.length?(i[e]=t[0],c):i[e]}),c},H=(e,t)=>W(e,t,s.chartSvgCartesian,!1),I=(e,t)=>W(e,t,s.chartCanvasCartesian,!0),W=(e,t,n,a)=>{let r=null,o=null;const l=n({xScale:e.scale,yScale:t.scale,xAxis:e.component,yAxis:t.component}).xDomain(e.domain).xLabel(e.label).xAxisHeight(e.size).xDecorate(e.decorate).xTickFormat(e.tickFormatFunction).yDomain(t.domain).yLabel(t.label).yAxisWidth(t.size).yDecorate(t.decorate).yOrient("left").yTickFormat(t.tickFormatFunction);e.decorate&&l.xDecorate(e.decorate),t.decorate&&l.yDecorate(t.decorate),l.xPaddingInner&&l.xPaddingInner(1),l.xPaddingOuter&&l.xPaddingOuter(.5),l.yPaddingInner&&l.yPaddingInner(1),l.yPaddingOuter&&l.yPaddingOuter(.5),l.axisSplitter=(...e)=>e.length?(r=e[0],l):r,l.altAxis=(...e)=>e.length?(o=e[0],l):o;const i=l.decorate();return l.decorate((n,c)=>{const u=n.select("d3fc-svg.plot-area");if(u.select("svg").node().setAttribute("viewBox","0 0 ".concat(u.node().clientWidth," ").concat(u.node().clientHeight)),i(n,c),r){if(r.haveSplit()){const i=r.altData(),u=s.dataJoin("d3fc-svg","y2-axis").key(e=>e),h=s.dataJoin("g","y-series").key(e=>e);n.enter().append("div").attr("class","y2-label-container").style("grid-column",5).style("-ms-grid-column",5).style("grid-row",3).style("-ms-grid-row",3).style("width",o.size||"1em").style("display","flex").style("align-items","center").style("justify-content","center").append("div").attr("class","y-label").style("transform","rotate(-90deg)");const p=o.scale.domain(o.domain),g=o.component.right(p);if(g.tickFormat(o.tickFormatFunction),o.decorate&&g.decorate(o.decorate),u(n,["right"]).attr("class",e=>"y-axis ".concat(e,"-axis")).on("measure",(e,t,n)=>{const{width:a,height:r}=d.event.detail;"left"===e&&d.select(n[t]).select("svg").attr("viewBox","".concat(-a," 0 ").concat(a," ").concat(r)),p.range([r,0])}).on("draw",(e,t,n)=>{d.select(n[t]).select("svg").call(g)}),a){const a=n=>{const a=l.plotArea();a.context(n.node().getContext("2d")).xScale(e.scale);const r=[t.scale,p];[c,i].forEach((e,t)=>{a.yScale(r[t]),a(e)})};n.select("d3fc-canvas.plot-area").on("draw",(e,t,n)=>{a(d.select(n[t]).select("canvas"))})}else{const a=n=>{const a=l.plotArea();a.xScale(e.scale);const r=[t.scale,p];h(n,[c,i]).each((e,t,n)=>{a.yScale(r[t]),d.select(n[t]).datum(e).call(a)})};n.select("d3fc-svg.plot-area").on("draw",(e,t,n)=>{a(d.select(n[t]).select("svg"))})}}r(n)}}),l};function U(e,t,n){let a=e.select(t);return a.size()>0?a:n()}function K(e,t,n="right"){if("right"===n||"bottom"===n)return e[n]<t[n];if("left"===n||"top"===n)return e[n]>t[n];throw"Direction being checked for overflow is invalid: ".concat(n)}function Y(e,t,n,a=0){const r="x"===e?"width":"height",o=t[e],l=t[e]+t[r],i=n[e],s=n[e]+n[r];return i+a>o&&i-a<l||s+a>o&&s-a<l||i+a<o&&s-a>l}var J=n(15),G=n.n(J);function X(e,t){switch(e){case"date":case"datetime":return t instanceof Date?t:new Date(parseInt(t));case"integer":return parseInt(t,10);case"float":return parseFloat(t)}return t}function $(e,t){if(0===t.crossValues.length)return[];return((e.crossValue.split?e.crossValue.split("|"):[e.crossValue])||[e.key]).map((e,n)=>({name:t.crossValues[n].name,value:X(t.crossValues[n].type,e)}))}function Q(e,t){if(0===t.splitValues.length)return[];const n=e.key?e.key.split("|"):e.mainValue.split?e.mainValue.split("|"):[e.mainValue];return t.splitValues.map((e,t)=>({name:e.name,value:X(e.type,n[t])}))}function Z(e,t){return t.mainValues.length>1?e.mainValue?[{name:e.key,value:e.mainValue-(e.baseValue||0)}]:t.mainValues.map((t,n)=>({name:t.name,value:X(t.type,e.mainValues[n])})):[{name:t.mainValues[0].name,value:X(t.mainValues[0].type,e.colorValue||e.mainValue-e.baseValue||e.mainValue||e.mainValues)}]}var ee=n(10);function te(e,t,n){!function(e,t){e.select("#tooltip-values").selectAll("li").data(t).join("li").each((function(e){Object(d.select)(this).text("".concat(e.name,": ")).append("b").text(ne(e.value))}))}(e,$(t,n).concat(Q(t,n)).concat(Z(t,n)))}const ne=e=>e.toLocaleString(void 0,{style:"decimal",minimumFractionDigits:Object(ee.get_type_config)("float").precision,maximumFractionDigits:Object(ee.get_type_config)("float").precision}),ae=e=>[e.name,"==",e.value],re=(e,t,n)=>{const a=Z(t,n).map(e=>e.name),r=$(t,n).map(ae),o=Q(t,n).map(ae),l=n.filter.concat(r).concat(o);e.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{column_names:a,config:{filters:l},row:t.row}}))},oe=()=>{let e=!1,t=null,n=null,a=!1;const r=r=>{const o=r.node();if(!o||!o.isConnected)return void le(t);const l=Object(d.select)(T(o));t=function(e){return U(e,"div.tooltip",()=>e.append("div").attr("class","tooltip").style("z-index",3).style("opacity",0).html(G.a))}(l);const i=(e,r,o)=>{te(t,e,n),function(e,t,n,a){const r=e.getBoundingClientRect(),o=t.getBoundingClientRect();let l=o.left+o.width/2-r.left,i=o.top-r.top+e.scrollTop;a&&(i=o.top+o.height/2-r.top+e.scrollTop);n.style("left","".concat(l,"px")).style("top","".concat(i,"px")).transition().duration(200).style("opacity",.9),a&&([l,i]=function(e,t){const n=e.node().getBoundingClientRect(),a=n.width/2,r=n.left-a-t.left;e.style("left","".concat(r,"px"));const o=n.height/2,l=n.top-o-t.top;return e.style("top","".concat(l,"px")),[r,l]}(n,r));!function(e,t,n,a,r=!1){const o=e.node().getBoundingClientRect();if(K(t,o)){const a=o.right-t.right;e.style("left","".concat(n-a,"px"))}if(K(t,o,"bottom")){const n=o.bottom-t.bottom;e.style("top","".concat(a-n,"px"))}if(!r)return;if(K(t,o,"left")){const a=o.left-t.left;e.style("left","".concat(n-a,"px"))}if(K(t,o,"top")){const n=o.top-t.top;e.style("top","".concat(a-n,"px"))}}(n,r,l,i,a)}(l.node(),o[r],t,a),Object(d.select)(o[r]).style("opacity","0.7")},s=(e,n,a)=>{le(t),a&&Object(d.select)(a[n]).style("opacity","1")};e?r.each(i):(r.on("mouseover",i).on("mouseout",s),(()=>{let e=null;const t=t=>{const n=t.node();t.on("click",t=>re(n,t,e))};return t.settings=(...n)=>n.length?(e=n[0],t):e,t})().settings(n)(r))};return r.alwaysShow=(...t)=>t.length?(e=t[0],r):e,r.centered=(...e)=>e.length?(a=e[0],r):a,r.settings=(...e)=>e.length?(n=e[0],r):n,r};function le(e){e&&e.transition().duration(500).style("opacity",0)}function ie(e,t){let n=e.mainValues.length>1?s.seriesSvgGrouped(s.seriesSvgBar()):s.seriesSvgBar();return n=n.decorate(n=>{oe().settings(e)(n),n.style("fill",e=>t(e.key))}),s.autoBandwidth(se(n)).crossValue(e=>e.crossValue).mainValue(e=>e.mainValue).baseValue(e=>e.baseValue)}const se=e=>{const t=t=>e(t);return s.rebindAll(t,e),t.bandwidth=(...n)=>n.length?(e.bandwidth(Math.max(n[0],1)),t):e.bandwidth(),t};function ce(e){return e.split("|").slice(0,-1).join("|")}function ue(e){const t=e.data&&e.data.length>0?e.data[0]:{},n=Object.keys(t).filter(e=>"__ROW_PATH__"!==e);return de().settings(e).domain(n)()}function de(){let e=null,t=null,n={},a=e=>pe(e,n.colorStyles&&n.colorStyles.opacity);const r=()=>{const r=n.colorStyles,o=t||[r.series];if(o||e.length>1){const t=e.length>1?r.scheme:o;return d.scaleOrdinal(t.map(a)).domain(e)}return null};return r.domain=(...t)=>t.length?(e=t[0],r):e,r.defaultColors=(...e)=>e.length?(t=e[0],r):t,r.mapFunction=(...e)=>e.length?(a=e[0],r):a,r.settings=(...e)=>e.length?(n=e[0],r):n,r}function he(e){return ge(1)(e)}function pe(e,t=.5){return ge(t)(e)}function ge(e){return t=>{const n=d.color(t);return n.opacity=e,n+""}}const me={none:y,ordinal:L,time:z,linear:_},fe=e=>{const t=u(e);let n="__ROW_PATH__";const a=(e,a)=>me[t()](n)(e,a);return Object(s.rebindAll)(a,t),a.valueName=(...e)=>e.length?(n=e[0],a):n,a};function ye(e,t,{stack:n=!1,excludeEmpty:a=!1}={}){const r=t||e.data;return e.splitValues.length>0?function(e,t,{stack:n=!1,excludeEmpty:a=!1}){const r={};return t.forEach(e=>{const t={},o={};Object.keys(e).filter(e=>"__ROW_PATH__"!==e).filter(t=>!a||null!=e[t]&&null!=e[t]).forEach(a=>{const r=a.split("|"),l=r[r.length-1],i=e[a]||0,s="".concat(l).concat(i>=0?"+ve":"-ve"),c=r.slice(0,r.length-1).join("|"),u=o[c]=o[c]||{__ROW_PATH__:e.__ROW_PATH__},d=t[s]||0;u.__KEY__=c,n?(u[l]=d+i,u["__BASE_VALUE__".concat(l)]=d,t[s]=u[l]):u[l]=i,u.row=e}),Object.keys(o).forEach(e=>{(r[e]=r[e]||[]).push(o[e])})}),Object.keys(r).map(e=>{const t=r[e];return t.key=e,t})}(0,r,{stack:n,excludeEmpty:a}):[r]}function be(e,t){const n={stack:!0};return ye(e,t,n).map(t=>xe(e,t,n))}function xe(e,t,{stack:n=!1}){const a=function(e,t,{stack:n=!1}){const a=fe(e);return e=>{const r=t=>n&&t["__BASE_VALUE__".concat(e.name)]||0,o=t.map((t,n)=>({crossValue:a(t,n),mainValue:t[e.name]?t[e.name]:null,baseValue:r(t),key:t.__KEY__?"".concat(t.__KEY__,"|").concat(e.name):e.name,row:t.row||t}));return o.key=o[0].key,o}}(e,t,{stack:n});return e.mainValues.length>1?e.mainValues.map(a):a(e.mainValues[0])}var ve=n(8),we=n(16),Oe=n.n(we);const Ve=10;function _e(e,t,n){const a=d.select(E(e).getContainer()).node().getBoundingClientRect(),r=e.getBoundingClientRect(),o={top:r.top+n-Ve,right:r.right+t+Ve,bottom:r.bottom+n+Ve,left:r.left+t-Ve},l={x:t,y:n};return[{edge:"right",dimension:"x"},{edge:"left",dimension:"x"},{edge:"top",dimension:"y"},{edge:"bottom",dimension:"y"}].forEach(e=>{if(K(a,o,e.edge)){const t=o[e.edge]-a[e.edge];l[e.dimension]=l[e.dimension]-t}}),l}function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ke="resize.for-dragging";function ze(){let e=!0,t=null;const n=n=>{const a=n.node();a.style.cursor="move",t.legend&&(a.style.left=t.legend.left,a.style.top=t.legend.top);const r=d.drag().on("drag",(function(){const n=_e(this,d.event.dx,d.event.dy);this.style.left="".concat(this.offsetLeft+n.x,"px"),this.style.top="".concat(this.offsetTop+n.y,"px");const r={left:this.style.left,top:this.style.top};t.legend=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.legend,{},r),e=function(e){const t=e.getBoundingClientRect(),n=d.select(T(e)).node().getBoundingClientRect();return t.right+Ve+5>=n.right&&t.top-Ve-5<=n.top}(a)?function(e){return d.select(window).on(ke,null),e.style.left="auto",!0}(a):function(e,t){!1!==t&&d.select(window).on(ke,(function(){const t=_e(e,0,0);e.style.left="".concat(e.offsetLeft+t.x,"px"),e.style.top="".concat(e.offsetTop+t.y,"px")}));return!1}(a,e)}));n.call(r)};return n.settings=(...e)=>e.length?(t=e[0],n):t,n}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ne="horizontal-drag-handle",Ce="vertical-drag-handle",Me="corner-drag-handle",Ee="dragHandles",Te=0,Re="resize";function De(){let e=9,t=3,n=null;const a={height:100,width:100},r={height:null,width:null},o=[],l=(e,t)=>o.filter(t=>t.event===e).forEach(e=>e.execute(t)),i=a=>{if(Be(a))return;const o={left:()=>l(Re,{horizontal:k(d.event),vertical:!1}),top:()=>l(Re,{horizontal:!1,vertical:P(d.event)}),right:()=>l(Re,{horizontal:z(d.event),vertical:!1}),bottom:()=>l(Re,{horizontal:!1,vertical:A(d.event)}),topleft:()=>l(Re,{horizontal:k(d.event),vertical:P(d.event)}),topright:()=>l(Re,{horizontal:z(d.event),vertical:P(d.event)}),bottomright:()=>l(Re,{horizontal:z(d.event),vertical:A(d.event)}),bottomleft:()=>l(Re,{horizontal:k(d.event),vertical:A(d.event)})},i=a.node();n.legend&&(i.style.height=n.legend.height,i.style.width=n.legend.width);const u=i.getBoundingClientRect(),h=a.append("svg").attr("id",Ee).attr("width",u.width).attr("height",u.height),p=h.append("g"),g=e=>"left"===e||"right"===e,m={left:0,top:e,right:u.width-e,bottom:e},f={left:e,top:0,right:e,bottom:u.height-e},[y,b,x,v]=["left","top","right","bottom"].map(n=>p.append("rect").attr("id","drag".concat(n)).attr("class",g(n)?Ce:Ne).attr("y",f[n]).attr("x",m[n]).attr("height",g(n)?u.height-2*e:e).attr("width",g(n)?e:u.width-2*e).attr("fill",g(n)?"lightgreen":"lightblue").attr("fill-opacity",Te).style("z-index",t).attr("cursor",g(n)?"ew-resize":"ns-resize").call(d.drag().on("drag",o[n]))),w=e=>"".concat(e[0]).concat(e[1]),O={topleft:"nwse",topright:"nesw",bottomright:"nwse",bottomleft:"nesw"},[V,_,j,S]=[["top","left"],["top","right"],["bottom","right"],["bottom","left"]].map(n=>p.append("rect").attr("id","drag".concat(w(n))).attr("class","".concat(Me," ").concat(n[0]," ").concat(n[1])).attr("height",e).attr("width",e).attr("fill","red").attr("fill-opacity",Te).style("z-index",t).attr("cursor","".concat(O[w(n)],"-resize")).call(d.drag().on("drag",o[w(n)])));function k(e){const t=c(_e(y.node(),e.x,0).x,h,"width",(e,t)=>e-t);return i.style.left="".concat(i.offsetLeft+t,"px"),i.style.width="".concat(i.offsetWidth-t,"px"),N(),C(x,t,"width","x")}function z(e){const t=-c(_e(x.node(),e.dx,0).x,h,"width",(e,t)=>e+t);return!s(t,"x",x,e)&&(i.style.width="".concat(i.offsetWidth-t,"px"),N(),C(x,t,"width","x"))}function P(e){const t=c(_e(b.node(),0,e.y).y,h,"height",(e,t)=>e-t);return i.style.top="".concat(i.offsetTop+t,"px"),i.style.height="".concat(i.offsetHeight-t,"px"),N(),C(v,t,"height","y")}function A(e){const t=-c(_e(v.node(),0,e.dy).y,h,"height",(e,t)=>e+t);return!s(t,"y",v,e)&&(i.style.height="".concat(i.offsetHeight-t,"px"),N(),C(v,t,"height","y"))}function N(){const e={top:i.style.top,left:i.style.left,height:i.style.height,width:i.style.width};n.legend=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.legend,{},e)}function C(e,t,n,a){return Fe(h,n,t),qe(e,a,t),Le(h,t,n,"height"===n?Ce:Ne),M(h),0!=t}function M(t){V.attr("y",0,"x",0),_.attr("y",0).attr("x",t.attr("width")-e),j.attr("y",t.attr("height")-e).attr("x",t.attr("width")-e),S.attr("y",t.attr("height")-e).attr("x",0)}function E(e,t,n){r[e]&&r[e]<u[e]&&(i.style[e]="".concat(r[e],"px"),C(n,u[e]-r[e],e,t))}E("height","y",v),E("width","x",x),M(h)};function s(e,t,n,a){return((e,t,n,a)=>e<0&&a[t]<Number(n.attr(t)))(e,t,n,a)||((e,t,n,a)=>e>0&&a[t]>Number(n.attr(t)))(e,t,n,a)}function c(e,t,n,o){const l=o(Number(t.attr(n)),e);if(l<a[n]){return o(e,a[n]-l)}if(r[n]&&l>r[n]){return o(e,r[n]-l)}return e}return i.on=(e,t)=>(o.push({event:e,execute:t}),i),i.zIndex=e=>(t=e,i),i.settings=(...e)=>e.length?(n=e[0],i):n,i.minWidth=e=>(a.width=e,r.width&&(r.width=Math.max(a.width,r.width)),i),i.minHeight=e=>(a.height=e,r.height&&(r.height=Math.max(a.height,r.height)),i),i.handleWidth=t=>(e=t,i),i.maxWidth=e=>(r.width=e,a.width=Math.min(a.width,r.width),i),i.maxHeight=e=>(r.height=e,a.height=Math.min(a.height,r.height),i),i}const Le=(e,t,n,a)=>{e.selectAll(".".concat(a)).each((e,a,r)=>{const o=r[a];d.select(o).attr(n,o.getBoundingClientRect()[n]-t)})},Be=e=>e.select("#".concat(Ee)).size()>0,qe=(e,t,n)=>e.attr(t,Number(e.attr(t))-n),Fe=(e,t,n)=>e.attr(t,e.node().getBoundingClientRect()[t]-n);function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var We=(e,t)=>{const n=e||ve.legendColor();let a,r,o=[],l=1,i=t.legend&&t.legend.pageIndex?t.legend.pageIndex:0,c=()=>{},u=ze().settings(t);const d=e=>{o=n.scale().domain(),r=De().settings(t).maxHeight(16*o.length+20).on("resize",()=>h(e)),r(e),u(e),h(e)},h=e=>{y(e),p(e),g(e),function(e){const t=e.select("g.legendCells"),n=e.node().getBoundingClientRect();if(!K(n,t.node().getBoundingClientRect()))return;const a=e.select(".legend");t.selectAll(".label").text((e,t,r)=>{const o=r[t];if(K(n,o.getBoundingClientRect())){const t=function(e,t,n){const a=e.getBoundingClientRect(),r=t.node().createSVGPoint();return r.x=n.right-a.left-3,r.y=0,e.getCharNumAtPosition(r)}(o,a,n);return"".concat(e.substring(0,t-3),"...")}return e})}(e)},p=e=>{const t=x(e);t.style("display",l<=1?"none":"block"),t.select("#page-text").text("".concat(i+1,"/").concat(l)),t.select("#up-arrow").attr("class",0===i?"disabled":"").on("click",()=>{i>0&&(m(i-1),h(e))}),t.select("#down-arrow").attr("class",i>=l-1?"disabled":"").on("click",()=>{i<l-1&&(m(i+1),h(e))})},g=e=>{l>1&&n.cellFilter(f()),e.select("g.legendCells").remove();const t=v(e);t.call(n);const a=e.select("g.legendCells").node().getBBox();t.attr("height",a.height+20),c(e)},m=e=>{i=e,t.legend=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.legend,{pageIndex:i})},f=()=>(e,t)=>t>=a*i&&t<a*i+a,y=e=>{const t=e.node().getBoundingClientRect();let n=Math.floor(t.height/16)-1;a=n<o.length?n-1:n,l=b(n),i=Math.min(i,l-1)},b=e=>Math.ceil(o.length/e),x=e=>U(e,".legend-controls",()=>e.append("g").attr("class","legend-controls").html(Oe.a)),v=e=>U(e,".legend",()=>e.append("svg").attr("class","legend"));return d.decorate=(...e)=>e.length?(c=e[0],d):c,Object(s.rebindAll)(d,n),d};const Ue=e=>We(ve.legendColor().shape("circle").shapeRadius(6),e),Ke=e=>We(ve.legendSymbol().shapePadding(1).labelOffset(3),e),Ye=()=>Xe(Ue),Je=()=>Xe(Ke,Ge);function Ge(e){if(!e)return null;const t=e.domain(),n=e.range().map(e=>d.symbol().type(e)());return d.scaleOrdinal().domain(t).range(n)}function Xe(e,t){let n={},a=null,r=null;function o(t){if(a&&a.range().length>1){const o=e(n);o.scale(a).orient("vertical").on("cellclick",(function(e){n.hideKeys=n.hideKeys||[],n.hideKeys.includes(e)?n.hideKeys=n.hideKeys.filter(t=>t!==e):n.hideKeys.push(e),E(this).draw()})),o.labels(e=>{const t=e.domain[e.i].split("|");return n.mainValues.length<=1&&t.length>1?t.slice(0,t.length-1).join("|"):e.domain[e.i]});const l=U(t,"div.legend-container",()=>t.append("div"));o.decorate(e=>{const t=e=>n.hideKeys&&n.hideKeys.includes(e),a=e.select("g.legendCells").attr("transform","translate(20,20)").selectAll("g.cell");a.classed("hidden",t),a.append("title").html(e=>e),r&&a.select("path").style("fill",e=>t(e)?null:r(e)).style("stroke",e=>t(e)?null:he(r(e)))}),l.attr("class","legend-container").attr("borderbox-on-hover",!0).style("z-index","2").call(o)}}return o.settings=(...e)=>e.length?(n=e[0],o):n,o.scale=(...e)=>e.length?(a=t?t(e[0]):e[0],o):a,o.color=(...e)=>e.length?(r=e[0],o):r,o}function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ze(e,t){const n=t||e.data;return e.hideKeys&&e.hideKeys.length>0?n.map(t=>{const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach((function(t){Qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t);return e.hideKeys.forEach(e=>{delete n[e]}),n}):n}function et(e,t){const n=t||e.data;return e.hideKeys&&e.hideKeys.length>0?n.map(t=>{const n={};return Object.keys(t).map(a=>{e.hideKeys.includes(ce(a))||(n[a]=t[a])}),n}):n}const tt=e=>{e.globalAlpha=.3,e.lineWidth=1},nt=e=>e.style("display","none"),at=e=>{e.globalAlpha=0};var rt=(e,t)=>{let n="both",a=!1,r=null,o=null,l=null,i=s.seriesSvgMulti(),c=s.annotationSvgGridline(),u=(e=>t=>t.style("opacity","0.3").style("stroke-width","1.0").style("stroke",e?e.colorStyles.grid.gridLineColor:"#bbb"))(t),d=nt;const h=function(...t){a&&(i=s.seriesCanvasMulti().context(l),c=s.annotationCanvasGridline(),u=tt,d=at);const h=i.xScale(r).yScale(o),p="vertical"===n?d:u,g="horizontal"===n?d:u,m=c.xDecorate(p).yDecorate(g);return h.series([m,e])(...t)};return h.orient=(...e)=>e.length?(n=e[0],h):n,h.canvas=(...e)=>e.length?(a=e[0],h):a,h.xScale=(...e)=>e.length?(r=e[0],h):r,h.yScale=(...e)=>e.length?(o=e[0],h):o,h.context=(...e)=>e.length?(l=e[0],h):l,h};const ot=()=>{const e=x(),t=t=>{let n=e.pad(),a=e.padUnit(),r=1;switch(a){case"domain":break;case"percent":r=t[1]-t[0];break;default:throw new Error("Unknown padUnit: "+a)}let o=t[0]-n[0]*r,l=t[1]+n[1]*r;return t[0]=t[0]>=0&&o<0?0:o,t[1]=t[1]<=0&&l>0?0:l,t};return s.rebindAll(t,e),t};var lt=n(17),it=n.n(lt);function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ut=()=>{let e=null,t=null,n=null,a=null,r=null,o=null,l=!1,i=!1,s=()=>{};function c(s){const c="d3fc-".concat(i?"canvas":"svg",".plot-area");if(n||r){const i=a&&a.domain()[0]instanceof Date,p=d.zoom().on("zoom",()=>{const{transform:l}=d.event;t.zoom={k:l.k,x:l.x,y:l.y},u(l),s.call(e);const g=1===l.k&&0===l.x&&0===l.y,m=h(s).style("display",g?"none":"");m.select("#zoom-reset").on("click",()=>s.select(c).call(p.transform,d.zoomIdentity));const f=m.select("#one-year").style("display",i?"":"none"),y=m.select("#six-months").style("display",i?"":"none"),b=m.select("#one-month").style("display",i?"":"none");if(i){const e=e=>()=>{const t=new Date(n.domain()[0]),l=new Date(t);e(t,l);const i=a.range(),u=(i[1]-i[0])/(a(l)-a(t)),h=-a(t)*u;let g=0;if(r){const e=r.domain().reduce((e,t)=>e+t)/2;g=-o(e)*u+r(e)}s.select(c).call(p.transform,d.zoomIdentity.translate(h,g).scale(u))};f.on("click",e((e,t)=>t.setYear(e.getFullYear()+1))),y.on("click",e((e,t)=>t.setMonth(e.getMonth()+6))),b.on("click",e((e,t)=>t.setMonth(e.getMonth()+1)))}}),g=e.decorate();e.decorate((e,n)=>{if(g(e,n),!l){l=!0;const n=e.select(c);n.on("measure.zoom-range",()=>{if(a&&a.range([0,d.event.detail.width]),o&&o.range([0,d.event.detail.height]),t.zoom){const e=d.zoomIdentity.translate(t.zoom.x,t.zoom.y).scale(t.zoom.k);n.call(p.transform,e)}}).call(p)}})}s.call(e)}c.chart=(...t)=>t.length?(e=t[0],c):e,c.settings=(...e)=>e.length?(t=e[0],c):t,c.xScale=(...e)=>e.length?(n=p(e[0]),a=n?n.copy():null,c):n,c.yScale=(...e)=>{if(!e.length)return r;if(r=p(e[0]),o=r?r.copy():null,o){const e=o.domain();o.domain([e[1],e[0]])}return c},c.canvas=(...e)=>e.length?(i=e[0],c):i,c.onChange=(...e)=>e.length?(s=e[0],c):s;const u=e=>{const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);if(n&&(n.domain(e.rescaleX(a).domain()),t.xDomain=n.domain()),r){const n=e.rescaleY(o).domain();r.domain([n[1],n[0]]),t.yDomain=r.domain()}s(t)},h=e=>U(e,".zoom-controls",()=>e.append("div").attr("class","zoom-controls").style("display","none").html(it.a)),p=e=>e&&e.nice?e:null;return c};function dt(e,t){const n=be(t,Ze(t)),a=ue(t),r=Ye().settings(t).scale(a),o=ie(t,a).orient("horizontal"),l=s.seriesSvgMulti().mapping((e,t)=>e[t]).series(n.map(()=>o)),i=F(t).settingName("mainValues").valueName("mainValue").excludeType(c.ordinal).include([0]).paddingStrategy(ot())(n),u=F(t).excludeType(c.linear).settingName("crossValues").valueName("crossValue").orient("vertical")(n),d=H(i,u).plotArea(rt(l,t).orient("horizontal"));d.yPaddingInner&&(d.yPaddingInner(.5),d.yPaddingOuter(.25),o.align("left")),d.xNice&&d.xNice();const h=ut().chart(d).settings(t).yScale(u.scale);e.datum(n).call(h),e.call(r)}dt.plugin={type:"d3_x_bar",name:"X Bar Chart",max_cells:1e3,max_columns:50};var ht=dt,pt=(e,t)=>{if(!gt(e)||!gt(t))return;const n=mt(e),a=mt(t);n>a?t[0]=ft(t,n):e[0]=ft(e,a)};const gt=e=>2===e.length&&!isNaN(e[0])&&!isNaN(e[1])&&e[0]!==e[1],mt=e=>(0-e[0])/(e[1]-e[0]),ft=(e,t)=>t*e[1]/(t-1);n(13);const yt=(e,t,n=bt)=>{let a,r,o;const l=e.splitMainValues||[],i=e=>{const t=e.split("|");return l.includes(t[t.length-1])},c=e.mainValues.some(e=>i(e.name));r=c?n(t,e=>!i(e)):t,o=c?n(t,i):null;const u=t=>{if(1===e.mainValues.length)return;const n=e.mainValues.map((e,t)=>({index:t,name:e.name})),r=n.filter(e=>!i(e.name)),o=n.filter(e=>i(e.name)),l=()=>(e=>{let t,n=[],a=!1;const r=r=>{r.text("");const l=s.dataJoin("span","splitter-label").key(e=>e),i=!a&&1===n.length,c=t&&0===e.splitValues.length;l(r,n).classed("disabled",i).text(e=>e.name).style("color",e=>c?he(t(e.name)):void 0).on("click",t=>{i||(e.splitMainValues=a?e.splitMainValues.filter(e=>e!=t.name):[t.name].concat(e.splitMainValues||[]),o(r))})},o=e=>{const t=E(e.node());t.remove(),t.draw()};return r.labels=(...e)=>e.length?(n=e[0],r):n,r.alt=(...e)=>e.length?(a=e[0],r):a,r.color=(...e)=>e.length?(t=e[0],r):t,r})(e).color(a);t.select(".y-label-container>.y-label").call(l().labels(r)),t.select(".y2-label-container>.y-label").call(l().labels(o).alt(!0))};return u.color=(...e)=>e.length?(a=e[0],u):a,u.haveSplit=()=>c,u.data=(...e)=>e.length?(r=e[0],u):r,u.altData=(...e)=>e.length?(o=e[0],u):o,u},bt=(e,t)=>e.map(e=>e.filter(e=>t(e.key))),xt=(e,t)=>e.map(e=>t(e.key)?e:e.map(e=>Object.assign({},e,{mainValue:null}))),vt=(e,t)=>e.map(e=>xt(e,t));function wt(e,t){const n=be(t,Ze(t)),a=ue(t),r=Ye().settings(t).scale(a),o=ie(t,a).orient("vertical"),l=s.seriesSvgMulti().mapping((e,t)=>e[t]).series(n.map(()=>o)),i=F(t).excludeType(c.linear).settingName("crossValues").valueName("crossValue")(n),u=F(t).settingName("mainValues").valueName("mainValue").excludeType(c.ordinal).orient("vertical").include([0]).paddingStrategy(ot()),d=t.mainValues.length>1?vt:xt,h=yt(t,n,d).color(a),p=u(h.data()),g=h.haveSplit()?l:rt(l,t).orient("vertical"),m=H(i,p).axisSplitter(h).plotArea(g);m.xPaddingInner&&(m.xPaddingInner(.5),m.xPaddingOuter(.25),o.align("left")),m.yNice&&m.yNice();const f=ut().chart(m).settings(t).xScale(i.scale);if(h.haveSplit()){const e=u(h.altData());pt(p.domain,e.domain),m.yDomain(p.domain).altAxis(e)}e.datum(h.data()).call(f),e.call(r)}wt.plugin={type:"d3_y_bar",name:"Y Bar Chart",max_cells:1e3,max_columns:50};var Ot=wt;const Vt=function(e){const t=[];for(const n of e)for(let e=0;e<n.length;e++)null!==n[e].mainValue&&(t[e]=t[e]||[],t[e].push(n[e]));return t},_t=(e,t,n=Math.min)=>{const a=e=>e.reduce((e,a)=>{const o=r(a,t);return!o||e&&n(e.value,o.value)!==o.value?e:o},null),r=e=>{if(Array.isArray(e))return a(e);const n=t(e);return null!==n?{item:e,value:n}:null},o=a(e);return o?o.item:null};var jt=()=>{const e=oe().alwaysShow(!0);let t=null,n=null,a=null,r=null,o=!1,l=null,i="crossValue",c="mainValue",u=null;function d(a){const r="d3fc-".concat(o?"canvas":"svg",".plot-area");if(t||n){let t=null;const o=s.pointer().on("point",e=>{const r=e.length?p(e[0]):null;t=r?[r.data]:[];const o=r?r.scale:n;h(a,t,o)});a.select(r).on("measure.nearbyTip",()=>h(a,[])).on("click",()=>{t.length&&re(a.node(),t[0],e.settings())}).call(o)}}const h=(o,l,s=n)=>{const u=o.select("d3fc-svg.plot-area svg").selectAll("circle.nearbyTip").data(l);u.exit().remove(),u.enter().append("circle").attr("class","nearbyTip").merge(u).attr("r",e=>r?Math.sqrt(r(e.size)):10).attr("transform",e=>"translate(".concat(t(e[i]),",").concat(s(e[c]),")")).style("stroke","none").style("fill",e=>a&&pe(a(e.key))),e(u)},p=e=>{const a=n=>a=>void 0===a[c]||null===a[c]||void 0===a[i]||null===a[i]?null:Math.sqrt(Math.pow(t(a[i])-e.x,2)+Math.pow(n(a[c])-e.y,2)),r=a(n),o=_t(l,r,Math.min);if(u){const e=a(u.yScale),t=_t(u.data,e,Math.min);return r(o)<=e(t)?{data:o,scale:n}:{data:t,scale:u.yScale}}return{data:o,scale:n}};return d.xScale=(...e)=>e.length?(t=e[0],d):t,d.yScale=(...e)=>e.length?(n=e[0],d):n,d.color=(...e)=>e.length?(a=e[0],d):a,d.size=(...e)=>e.length?(r=e[0]?e[0].copy().range([40,4e3]):null,d):r,d.canvas=(...e)=>e.length?(o=e[0],d):o,d.data=(...e)=>e.length?(l=e[0],d):l,d.xValueName=(...e)=>e.length?(i=e[0],d):i,d.yValueName=(...e)=>e.length?(c=e[0],d):c,d.altDataWithScale=(...e)=>e.length?(u=e[0],d):u,s.rebindAll(d,e),d};function St(e,t){const n=function(e,t){const n=fe(e);return t.map((e,t)=>Object.keys(e).filter(e=>"__ROW_PATH__"!==e).map(a=>({key:a,crossValue:n(e,t),mainValue:e[a],row:e})))}(t,Ze(t)),a=ue(t),r=Ye().settings(t).scale(a),o=s.seriesSvgRepeat().series(function(e,t){let n=s.seriesSvgLine();return n=n.decorate(e=>{e.style("stroke",e=>he(t(e[0]&&e[0].key)))}),n.crossValue(e=>e.crossValue).mainValue(e=>e.mainValue)}(0,a)).orient("horizontal"),l=ot().pad([.1,.1]).padUnit("percent"),i=F(t).excludeType(c.linear).settingName("crossValues").valueName("crossValue")(n),u=F(t).settingName("mainValues").valueName("mainValue").orient("vertical").paddingStrategy(l),d=yt(t,Vt(n)).color(a),h=u(d.data()),p=d.haveSplit()?o:rt(o,t).orient("vertical"),g=H(i,h).axisSplitter(d).plotArea(p);g.yNice&&g.yNice();const m=ut().chart(g).settings(t).xScale(i.scale),f=jt().settings(t).xScale(i.scale).yScale(h.scale).color(a).data(n);if(d.haveSplit()){const e=u(d.altData());g.altAxis(e),f.data(d.data()).altDataWithScale({yScale:e.scale,data:d.altData()})}const y=d.data();e.datum(y).call(m),e.call(f),e.call(r)}St.plugin={type:"d3_y_line",name:"Y Line Chart",max_cells:4e3,max_columns:50};var kt=St;function zt(e,t){const n=function(e,t){const n=fe(e);return t.map((e,t)=>{const a={};return Object.keys(e).filter(e=>"__ROW_PATH__"!==e).map(r=>{const o=r.split("|"),l=o[o.length-1],i=a[l]||0,s=i+e[r];return a[l]=s,{key:r,crossValue:n(e,t),mainValue:s,baseValue:i,row:e}})})}(t,Ze(t)),a=ue(t),r=Ye().settings(t).scale(a),o=s.seriesSvgRepeat().series(function(e,t){let n=s.seriesSvgArea();return n=n.decorate(e=>{e.style("fill",e=>t(e[0].key))}),n.crossValue(e=>e.crossValue).mainValue(e=>e.mainValue).baseValue(e=>e.baseValue)}(0,a).orient("vertical")),l=F(t).excludeType(c.linear).settingName("crossValues").valueName("crossValue")(n),i=F(t).settingName("mainValues").valueName("mainValue").excludeType(c.ordinal).orient("vertical").include([0]).paddingStrategy(ot()),u=yt(t,n).color(a),d=i(u.data()),h=u.haveSplit()?o:rt(o,t).orient("vertical"),p=H(l,d).axisSplitter(u).plotArea(h);p.yNice&&p.yNice();const g=ut().chart(p).settings(t).xScale(l.scale),m=jt().settings(t).xScale(l.scale).yScale(d.scale).color(a).data(n);if(u.haveSplit()){const e=i(u.altData());p.altAxis(e),m.data(u.data()).altDataWithScale({yScale:e.scale,data:u.altData()})}e.datum(u.data()).call(g),e.call(m),e.call(r)}zt.plugin={type:"d3_y_area",name:"Y Area Chart",max_cells:4e3,max_columns:50};var Pt=zt;const At=[d.symbolCircle,d.symbolCross,d.symbolDiamond,d.symbolSquare,d.symbolStar,d.symbolTriangle,d.symbolWye];function Nt(e){return e.length>1?d.scaleOrdinal().domain(e).range(At):null}function Ct(e,t){const n=function(e,t){const n={stack:!1},a=ye(e,t,n).map(t=>xe(e,t,n));if(e.mainValues.length>1){return a.reduce((e,t)=>e.concat(t))}return a}(t,Ze(t)),a=function(e){const t=e.data&&e.data.length>0?e.data[0]:{};return Nt(Object.keys(t).filter(e=>"__ROW_PATH__"!==e))}(t),r=ue(t),o=Je().settings(t).scale(a).color(r),l=s.seriesSvgMulti().mapping((e,t)=>e[t]).series(n.map(e=>(function(e,t,n,a){let r=s.seriesSvgPoint().size(100);const o=e.colorStyles&&e.colorStyles.opacity;return a&&r.type(a(t)),r.decorate(e=>{e.style("stroke",e=>he(n(e.colorValue||t))).style("fill",e=>pe(n(e.colorValue||t),o))}),r.crossValue(e=>e.crossValue).mainValue(e=>e.mainValue)})(t,e.key,r,a))),i=ot().pad([.05,.05]).padUnit("percent"),u=F(t).excludeType(c.linear).settingName("crossValues").valueName("crossValue")(n),d=F(t).settingName("mainValues").valueName("mainValue").orient("vertical").paddingStrategy(i),h=yt(t,n).color(r),p=d(h.data()),g=h.haveSplit()?l:rt(l,t).orient("vertical"),m=H(u,p).axisSplitter(h).plotArea(g);m.yNice&&m.yNice();const f=ut().chart(m).settings(t).xScale(u.scale),y=jt().settings(t).xScale(u.scale).yScale(p.scale).color(r).data(n);if(h.haveSplit()){const e=d(h.altData());m.altAxis(e),y.data(h.data()).altDataWithScale({yScale:e.scale,data:h.altData()})}e.datum(h.data()).call(f),e.call(y),o&&e.call(o)}Ct.plugin={type:"d3_y_scatter",name:"Y Scatter Chart",max_cells:4e3,max_columns:50};var Mt=Ct;function Et(e,t){return ye(e,t,{excludeEmpty:!0}).map(t=>(function(e,t){const n=fe(e),a=t.map((a,r)=>({crossValue:n(a,r),mainValues:e.mainValues.map(e=>a[e.name]),x:a[e.mainValues[0].name],y:a[e.mainValues[1].name],colorValue:e.realValues[2]?a[e.realValues[2]]:void 0,size:e.realValues[3]?a[e.realValues[3]]:void 0,key:t.key,row:a}));return a.key=t.key,a})(e,t))}function Tt(e,t,n,a){let r=Rt(t,n,a),o=e.colorStyles.gradient.full;if(r[0]>=0)o=e.colorStyles.gradient.positive;else if(r[1]<=0)o=e.colorStyles.gradient.negative;else{const e=Math.max(-r[0],r[1]);r=[-e,e]}const l=Dt(o);return d.scaleSequential(l).domain(r)}const Rt=(e,t,n)=>n||V().valueName(t).pad([0,0])(e),Dt=e=>{const t=e.slice(1).map((t,n)=>d.interpolate(e[n][1],t[1]));return n=>{const a=e.findIndex((t,a)=>a<e.length-1&&n<=e[a+1][0]&&n>t[0]);if(-1===a)return n<=e[0][0]?e[0][1]:e[e.length-1][1];const r=t[a],[o]=e[a],[l]=e[a+1];return r((n-o)/(l-o))}};function Lt(){let e=null;function t(t){const n=U(t,"div.legend-container",()=>t.append("div").attr("class","legend-container legend-color").style("z-index","2")),{width:a,height:r}=n.node().getBoundingClientRect(),o=d.scaleBand().domain([0,1]).range([0,a]),l=e.copy().nice().domain(),i=s.extentLinear().pad([.1,.1]).padUnit("percent")(l),[c,u]=i,h=d.range(c,u,(u-c)/r),p=d.scaleLinear().domain(i).range([r,0]),g=s.autoBandwidth(s.seriesSvgBar()).xScale(o).yScale(p).crossValue(0).baseValue((e,t)=>t>0?h[t-1]:0).mainValue(e=>e).decorate(t=>{t.selectAll("path").style("fill",t=>e(t))}),m=l[0]<0&&l[1]>0?0:Math.round((l[1]+l[0])/2),f=[...l,m],y=s.axisRight(p).tickValues(f).tickSizeOuter(0).tickFormat(e=>w(e)),b=U(n,"svg",()=>n.append("svg")).style("width",a).style("height",r),x=U(b,"g",()=>b.append("g")).datum(h).call(g),v=Math.abs(x.node().getBBox().x);U(b,"#legend-axis",()=>b.append("g").attr("id","legend-axis")).attr("transform","translate(".concat(v,")")).datum(h).call(y).select(".domain").attr("visibility","hidden")}return t.scale=(...n)=>n.length?(e=n[0],t):e,t}function Bt(e,t){const n=Et(t,et(t)),a=function(e){const t=e.data&&e.data.length>0?e.data[0]:{},n=[];return Object.keys(t).forEach(e=>{if("__ROW_PATH__"!==e){const t=ce(e);n.includes(t)||n.push(t)}}),Nt(n)}(t),r=t.realValues.length<=2||null===t.realValues[2];let o=null,l=null;r?(o=function(e){const t=e.data&&e.data.length>0?e.data[0]:{},n=[];return Object.keys(t).forEach(e=>{if("__ROW_PATH__"!==e){const t=ce(e);n.includes(t)||n.push(t)}}),de().settings(e).domain(n)()}(t),l=Je().settings(t).scale(a).color(r?o:null)):(o=Tt(t,n,"colorValue"),l=Lt().scale(o));const i=t.realValues[3]?function(e,t,n,a){return d.scaleLinear().domain(Rt(t,n,a))}(0,n,"size").range([10,1e4]):null,c=s.seriesCanvasMulti().mapping((e,t)=>e[t]).series(n.map(e=>(function(e,t,n,a,r){let o=Object(s.seriesCanvasPoint)().crossValue(e=>e.x).mainValue(e=>e.y);return n&&o.size(e=>n(e.size)),r&&o.type(r(t)),o.decorate((n,r)=>{const o=a(void 0!==r.colorValue?r.colorValue:t),l=e.colorStyles&&e.colorStyles.opacity;n.strokeStyle=he(o),n.fillStyle=pe(o,l)}),o})(t,e.key,i,o,a))),u=()=>F(t).settingName("mainValues").paddingStrategy(ot()).pad([.1,.1]),h=u().settingValue(t.mainValues[0].name).valueName("x")(n),p=u().orient("vertical").settingValue(t.mainValues[1].name).valueName("y")(n),g=I(h,p).xLabel(t.mainValues[0].name).yLabel(t.mainValues[1].name).plotArea(rt(c,t).canvas(!0));g.xNice&&g.xNice(),g.yNice&&g.yNice();const m=ut().chart(g).settings(t).xScale(h.scale).yScale(p.scale).canvas(!0),f=jt().settings(t).canvas(!0).xScale(h.scale).xValueName("x").yValueName("y").yScale(p.scale).color(r&&o).size(i).data(n);e.datum(n).call(m),e.call(f),l&&e.call(l)}Bt.plugin={type:"d3_xy_scatter",name:"X/Y Scatter Chart",max_cells:5e4,max_columns:50,initial:{type:"number",count:2,names:["X Axis","Y Axis","Color","Size","Tooltip"]},selectMode:"toggle"};var qt=Bt;function Ft(e,t){const n=function(e,t){const n=fe(e),a=u(e).excludeType(c.linear).settingName("splitValues")(),r=[];return t.forEach((e,t)=>{const o=n(e,t);Object.keys(e).filter(e=>"__ROW_PATH__"!==e).forEach(t=>{const n=function(e){const t=e.split("|");return t.pop(),t.join("|")}(t);r.push({crossValue:o,mainValue:a===c.time?new Date(n):n,colorValue:e[t],row:e})})}),r}(t,Ze(t)),a=Tt(t,n,"colorValue"),r=function(e,t){let n=s.seriesSvgHeatmap();return n.decorate(n=>{oe().settings(e)(n),n.select("path").attr("fill",e=>t(e.colorValue))}),s.autoBandwidth(n).xValue(e=>e.crossValue).yValue(e=>e.mainValue).colorValue(e=>e.colorValue).colorInterpolate(t.interpolator()).widthFraction(1)}(t,a),o=Lt().scale(a),l=F(t).excludeType(c.linear).settingName("crossValues").valueName("crossValue")(n),i=F(t).excludeType(c.linear).settingName("splitValues").valueName("mainValue").orient("vertical")(n),d=H(l,i).plotArea(rt(r,t));d.xPaddingInner&&(d.xPaddingInner(0),d.xPaddingOuter(0),r.xAlign("right")),d.yPaddingInner&&(d.yPaddingInner(0),d.yPaddingOuter(0),r.yAlign("top"));const h=ut().chart(d).settings(t).xScale(l.scale).yScale(i.scale);e.datum(n).call(h),e.call(o)}Ft.plugin={type:"d3_heatmap",name:"Heatmap",max_cells:1e3,max_columns:50};var Ht=Ft;function It(e,t){return ye(e,t,{excludeEmpty:!0}).map(t=>(function(e,t){const n=fe(e),a=t.map((a,r)=>{const o=e.mainValues.length>=1?a[e.mainValues[0].name]:void 0,l=e.mainValues.length>=2?a[e.mainValues[1].name]:(n=>t[n<t.length-1?n+1:n][e.mainValues[0].name])(r);return{crossValue:n(a,r),mainValues:e.mainValues.map(e=>a[e.name]),openValue:o,closeValue:l,highValue:e.mainValues.length>=3?a[e.mainValues[2].name]:Math.max(o,l),lowValue:e.mainValues.length>=4?a[e.mainValues[3].name]:Math.min(o,l),key:t.key,row:a}});return a.key=t.key,a})(e,t))}const Wt=e=>e.closeValue>=e.openValue;var Ut=function(e){return function(t,n){const a=It(n,et(n)),r=s.indicatorBollingerBands().value(e=>e.openValue),o=a.map(e=>{const t=r(e);return e.map((e,n)=>Object.assign({bollinger:t[n]},e))}),l=a.map(e=>e.key).concat(n.hideKeys?n.hideKeys:[]).sort(),i=de().domain(l).settings(n).mapFunction(ge(1))(),c=Ye().settings(n).scale(l.length>1?i:null),u=function(e,t,n){const a=n.domain(),r=de().domain(a).settings(e).defaultColors([e.colorStyles["series-2"]]).mapFunction(ge(.5))(),o=de().settings(e).domain(a)(),l=t().crossValue(e=>e.crossValue).openValue(e=>e.openValue).highValue(e=>e.highValue).lowValue(e=>e.lowValue).closeValue(e=>e.closeValue).decorate((e,t)=>{const a=Wt(t)?n(t.key):r(t.key);e.fillStyle=a,e.strokeStyle=a}),i=s.seriesCanvasLine().mainValue(e=>e.bollinger.average).crossValue(e=>e.crossValue).decorate((e,t)=>{e.strokeStyle=o(t[0].key)}),c=s.seriesCanvasArea().mainValue(e=>e.bollinger.upper).baseValue(e=>e.bollinger.lower).crossValue(e=>e.crossValue).decorate((e,t)=>{e.fillStyle=ge(.25)(o(t[0].key))});return s.seriesCanvasMulti().series([c,l,i])}(n,e,i),d=s.seriesCanvasMulti().mapping((e,t)=>e[t]).series(o.map(()=>u)),h=ot().pad([.1,.1]).padUnit("percent"),p=F(n).settingName("crossValues").valueName("crossValue")(o),g=F(n).settingName("mainValues").valueNames(["lowValue","highValue"]).orient("vertical").paddingStrategy(h)(o),m=I(p,g).plotArea(rt(d,n).orient("vertical").canvas(!0));m.yNice&&m.yNice();const f=ut().chart(m).settings(n).xScale(p.scale).onChange(e=>{const t=o.map(t=>t.filter(t=>t.crossValue>=e.xDomain[0]&&t.crossValue<=e.xDomain[1]));m.yDomain(g.domainFunction(t))}).canvas(!0),y=jt().settings(n).xScale(p.scale).yScale(g.scale).yValueName("closeValue").color(i).data(o).canvas(!0);t.datum(o).call(f),t.call(y),t.call(c)}};const Kt=Ut(s.seriesCanvasOhlc);Kt.plugin={type:"d3_ohlc",name:"OHLC Chart",max_cells:3500,max_columns:50,initial:{type:"number",count:4,names:["Open","Close","High","Low"]},selectMode:"toggle"};var Yt=Kt;const Jt=Ut(s.seriesCanvasCandlestick);Jt.plugin={type:"d3_candlestick",name:"Candlestick Chart",max_cells:4e3,max_columns:50,initial:{type:"number",count:4,names:["Open","Close","High","Low"]},selectMode:"toggle"};var Gt=Jt;function Xt(e){const t={},n=e.realValues.map(t=>null===t?null:e.mainValues.find(e=>e.name===t));return e.data.forEach(a=>{const r=a.__ROW_PATH__;(function(e){const t=[];return Object.keys(e).forEach(e=>{if("__ROW_PATH__"!==e){const n=e.split("|").slice(0,-1).join("|");t.includes(n)||t.push(n)}}),t})(a).forEach(o=>{let l;t[o]||(t[o]=[]),l=t[o],r.forEach((t,i)=>{let s=l.find(e=>e.name===t);if(s||(s={name:t,children:[]},l.push(s)),e.realValues.length>1&&null!==e.realValues[1]){const t=$t(a,e.mainValues[1],o);s.color=s.color?s.color+t:t}if(e.realValues.length>2&&null!==e.realValues[2]){s.tooltip=[];for(let t=2;t<e.realValues.length;++t)s.tooltip.push($t(a,n[t],o))}if(i===r.length-1&&(s.name=r.slice(-1)[0],r.length===e.crossValues.length)){const t=$t(a,e.mainValues[0],o);s.size=t>0?t:0}l=s.children})})}),Object.entries(t).map(t=>{const n={name:"root",children:t[1]},a=d.hierarchy(n).sum(e=>e.size),r=d.partition().size([2*Math.PI,a.height+1])(a);return r.each(n=>{n.current=n,n.mainValues=1===e.realValues.length||null===e.realValues[1]&&null===e.realValues[2]?n.value:[n.value,n.data.color].concat(n.data.tooltip||[]).filter(e=>null!==e),n.crossValue=n.ancestors().slice(0,-1).reverse().map(e=>e.data.name).join("|"),n.key=t[0]}),{split:t[0],data:r,extents:Qt(e,t)}})}const $t=(e,t,n)=>n.length?e["".concat(n,"|").concat(t.name)]:e[t.name];function Qt(e,[t,n]){if(e.realValues.length>1&&null!==e.realValues[1]){return[Math.min(...e.data.map(n=>$t(n,e.mainValues[1],t))),Math.max(...n.map(e=>e.color))]}}const Zt=e=>Object(d.arc)().startAngle(e=>e.x0).endAngle(e=>e.x1).padAngle(e=>Math.min((e.x1-e.x0)/2,.005)).padRadius(e).innerRadius(t=>t.y0*e).outerRadius(t=>Math.max(t.y0*e,t.y1*e-1)),en=e=>e.y1<=3&&e.y0>=1&&e.x1>e.x0;n(23);const tn=e=>e.y1<=3&&e.y0>=1&&(e.y1-e.y0)*(e.x1-e.x0)>.06;function nn(e,t){const n=(e.x0+e.x1)/2*180/Math.PI,a=(e.y0+e.y1)/2*t;return"rotate(".concat(n-90,") translate(").concat(a,",0) rotate(").concat(n<180?0:180,")")}function an(e,t){let n=this.getBBox().width;if(n>t){let a=e.data.name;const r=Object(d.select)(this);for(;n>t;)a=a.substring(0,a.length-1),r.text(()=>a),n=this.getBBox().width;r.text(()=>"".concat(a.substring(0,a.length-3).replace(/\s+$/,""),"..."))}}const rn=(e,t,n,a,r,o,l,i,s)=>(c,u)=>{s.sunburstLevel[i]=c.data.name,c.parent?(n.datum(c.parent),n.style("cursor","pointer"),a.html("&#8682; ".concat(c.data.name))):(n.datum(e),n.style("cursor","default"),a.html("")),e.each(e=>e.target={x0:2*Math.max(0,Math.min(1,(e.x0-c.x0)/(c.x1-c.x0)))*Math.PI,x1:2*Math.max(0,Math.min(1,(e.x1-c.x0)/(c.x1-c.x0)))*Math.PI,y0:Math.max(0,e.y0-c.depth),y1:Math.max(0,e.y1-c.depth)});const h=t.transition().duration(u?0:750);r.transition(h).tween("data",e=>{const t=Object(d.interpolate)(e.current,e.target);return n=>e.current=t(n)}).filter((function(e){return+this.getAttribute("fill-opacity")||en(e.target)})).attr("fill-opacity",e=>en(e.target)?1:0).attr("user-select",e=>en(e.target)?"initial":"none").attr("pointer-events",e=>en(e.target)?"initial":"none").attrTween("d",e=>()=>Zt(l)(e.current)),o.filter((function(e){return+this.getAttribute("fill-opacity")||tn(e.target)})).transition(h).attr("fill-opacity",e=>+tn(e.target)).attrTween("transform",e=>()=>nn(e.current,l))};function on(){let e=null,t=null,n=null,a=null,r=null;const o=o=>{const l=o.selectAll("g.segment").data(n.descendants().slice(1)),i=l.enter().append("g").attr("class","segment");i.append("path"),i.append("text").attr("class","segment").attr("dy","0.35em");const s=i.merge(l),c=s.select("path").attr("fill-opacity",e=>en(e.current)?1:0).attr("user-select",e=>en(e.current)?"initial":"none").attr("pointer-events",e=>en(e.current)?"initial":"none").attr("d",e=>Zt(r)(e.current));a&&c.style("fill",e=>a(e.data.color));const u=s.select("text").attr("fill-opacity",e=>+tn(e.current)).attr("transform",e=>nn(e.current,r)).text(e=>e.data.name).each((function(e){an.call(this,e,r)})),d=o.select("text.parent"),h=o.select("circle").attr("r",r).datum(n),p=rn(n,o,h,d,c,u,r,t,e);if(e.sunburstLevel){const a=n.descendants().find(n=>n.data.name===e.sunburstLevel[t]);a&&p(a,!0)}else e.sunburstLevel={};h.on("click",e=>p(e,!1)),c.filter(e=>e.children).style("cursor","pointer").on("click",e=>p(e,!1))};return o.settings=(...t)=>t.length?(e=t[0],o):e,o.split=(...e)=>e.length?(t=e[0],o):t,o.data=(...e)=>e.length?(n=e[0],o):n,o.color=(...e)=>e.length?(a=e[0],o):a,o.radius=(...e)=>e.length?(r=e[0],o):r,o}function ln(){let e="element-prefix-unset",t=null,n=null,a=null,r=null,o=null;const l=l=>{const i=U(l,"div.inner-container",()=>l.append("div").attr("class","inner-container")),s=i.node().getBoundingClientRect(),c=s.height,u=s.width-0,d=l.datum(),h=Math.min(d.length,Math.floor(u/500)),p=Math.ceil(d.length/h);o={width:u/h,height:Math.min(c,Math.max(c/p,u/h))},c/p>.75*o.height&&(o.height=c/p),i.style("grid-template-columns","repeat(".concat(h,", ").concat(o.width,"px)")),i.style("grid-template-rows","repeat(".concat(p,", ").concat(o.height,"px)")),a=i.selectAll("div.".concat(e,"-container")).data(d,e=>e.split),a.exit().remove(),n=a.enter().append("div").attr("class","".concat(e,"-container")),r=n.append("div").attr("class","title-container").style("text-align","center").attr("display","inline-block").append("text").attr("class","title").style("text-align","left"),t=n.append("svg").append("g").attr("class",e)};return l.elementsPrefix=(...t)=>t.length?(e=t[0],l):e,l.chartContainer=()=>t,l.chartEnter=()=>n,l.chartDiv=()=>a,l.chartTitle=()=>r,l.containerSize=()=>o,l}function sn(e,t){if(0===t.crossValues.length)return void console.warn("Unable to render a chart in the absence of any groups.");const n=Xt(t),a=function(e,t){if(e.realValues.length>1&&null!==e.realValues[1])return Tt(e,null,null,h(t))}(t,n.map(e=>e.extents)),r=ln().elementsPrefix("sunburst");if(e.datum(n).call(r),a){const t=Lt().scale(a);e.call(t)}const o=r.chartContainer(),l=r.chartEnter(),i=r.chartDiv(),s=r.chartTitle(),c=r.containerSize();s.each((e,t,n)=>Object(d.select)(n[t]).text(e.split)),o.append("circle").attr("fill","none").attr("pointer-events","all"),o.append("text").attr("class","parent"),l.merge(i).select("svg").select("g.sunburst").attr("transform","translate(".concat(c.width/2,", ").concat(c.height/2,")")).each((function({split:e,data:n}){const r=Object(d.select)(this),o=this.parentNode,{width:l,height:i}=o.getBoundingClientRect(),s=(Math.min(l,i)-120)/6;on().settings(t).split(e).data(n).color(a).radius(s)(r),oe().settings(t)(r.selectAll("g.segment"))}))}sn.plugin={type:"d3_sunburst",name:"Sunburst",max_cells:7500,max_columns:50,initial:{type:"number",count:1,names:["Size","Color","Tooltip"]}};var cn=sn;function un(e,t){if(e.realValues.length<1||null===e.realValues[1])return;const n=t.filter(e=>e.height>0).map(e=>(function e(t,n=[]){return t.children&&t.children.length>0?t.children.forEach(t=>n.concat(e(t,n))):n.push(t.data.color),n})(e)).reduce((e,t)=>e.concat(t));return Tt(e,null,null,[Math.min(...n),Math.max(...n)])}const dn=e=>!(!e.target||!e.target.textAttributes),hn=(e,t,n)=>{e.selectAll("text").style("font-size",null).attr("class",e=>_n(e,t,n));const a=bn(e);vn(a),gn(a)},pn=e=>{e.each((e,t,n)=>{Object(d.select)(n[t]).selectAll("text").attr("dx",e.target.textAttributes.dx).attr("dy",e.target.textAttributes.dy).attr("class",e.target.textAttributes.class).style("font-size",e.target.textAttributes["font-size"])})},gn=e=>{const t=e=>e.getBoundingClientRect(),n=[];e.selectAll("text").filter((e,t,n)=>Object(d.select)(n[t]).attr("class")===jn.high).each((e,t,a)=>n.push(a[t])),e.selectAll("text").filter((e,t,n)=>Object(d.select)(n[t]).attr("class")===jn.low).each((e,a,r)=>{const o=r[a];n.filter(e=>Y("x",t(e),t(o))&&Y("y",t(e),t(o),-2)).forEach(()=>Object(d.select)(o).attr("dy",Number(Object(d.select)(o).attr("dy"))+19))})},mn=e=>Object(d.select)(e).style("opacity",yn[Object(d.select)(e).attr("class")]),fn=e=>Object(d.select)(e).style("opacity",null),yn={top:1,mid:.7,lower:0},bn=e=>e.filter((e,t,n)=>Object(d.select)(n[t]).selectAll("text").attr("class")!==jn.zero),xn=e=>e.selectAll("text").each((e,t,n)=>On(n[t])),vn=e=>e.selectAll("text").each((e,t,n)=>wn(n[t])),wn=e=>{const t=Object(d.select)(e),n=e.getBoundingClientRect();t.attr("dx",0-n.width/2).attr("dy",0+n.height/4)},On=e=>{const t=e.parentNode.childNodes[0],n=e.getBoundingClientRect(),a=t.getBoundingClientRect();Vn(e,a,n,"left")||Vn(e,a,n,"bottom")||Object(d.select)(e).attr("class",Object(d.select)(e).attr("class"))},Vn=(e,t,n,a)=>{if(K(t,n,a)){const t=parseInt(Object(d.select)(e).style("font-size"));return t>7?(Object(d.select)(e).style("font-size","".concat(t-1,"px")),wn(e),On(e)):(Object(d.select)(e).style("font-size",null),Object(d.select)(e).attr("class",jn.zero)),!0}return!1},_n=(e,t,n)=>{if(!n.filter(e=>""!==e).every(t=>e.crossValue.split("|").includes(t)))return jn.zero;switch(e.depth){case t+1:return jn.high;case t+2:return jn.low;default:return jn.zero}},jn={high:"top",low:"mid",zero:"lower"};var Sn=(e,t)=>{const n=d.treemap().size([e,t]).paddingInner(e=>1+2*e.height);return n.tile(d.treemapBinary),n};const kn=(e,t)=>t.every(t=>e.crossValue.split("|").includes(t));function zn(e,t,n,a,r,o){!function(e,t,n,a,r){const o={x:e.x0,y:e.y0,width:e.x1-e.x0,height:e.y1-e.y0},l={width:r.x1-r.x0,height:r.y1-r.y0},i={width:l.width/o.width,height:l.height/o.height};n.each(e=>{const n=(e.x0-o.x)*i.width,r=(e.y0-o.y)*i.height,l=Hn(e)*i.width,s=In(e)*i.height,c=kn(e,t)&&e.data.name!=t[a-1];e.mapLevel[a]={x0:n,x1:l+n,y0:r,y1:s+r,visible:c,opacity:c?1:0}}),e.mapLevel[a].levelRoot=!0}(e,t,n,a,r),e.mapLevel[a].levelRoot=!0,function(e,t,n,a){const r=Sn(t,n)(Object(d.hierarchy)(e.data).sum(e=>e.size)).descendants(),o=e.descendants();r.forEach((e,t)=>{o[t].mapLevel[a].x0=r[t].x0,o[t].mapLevel[a].x1=r[t].x1,o[t].mapLevel[a].y0=r[t].y0,o[t].mapLevel[a].y1=r[t].y1})}(e,o.node().getBoundingClientRect().width,o.node().getBoundingClientRect().height,a),An(n,a)}const Pn=(e,t)=>{e.each((e,n,a)=>{const r=Object(d.select)(a[n]).selectAll("text");e.mapLevel[t].textAttributes={dx:r.attr("dx"),dy:r.attr("dy"),class:r.attr("class"),"font-size":r.style("font-size")}})};function An(e,t){e.selectAll("text").each((e,n,a)=>{const r=Object(d.select)(a[n]),o=Object(d.select)(a[n]).datum(),l=r.attr("class");o.mapLevel[t].textLockedAt={opacity:yn[l]}})}function Nn(e,t,n,a,r,o,l,i,s){if(!e.children)return;r.treemapLevel<e.depth?r.treemapRoute.push(e.crossValue):r.treemapRoute.pop(),r.treemapLevel=e.depth;const c=e.crossValue.split("|");e.mapLevel[r.treemapLevel]&&e.mapLevel[r.treemapLevel].levelRoot||zn(e,c,n,r.treemapLevel,i,o),Cn(e,t,n,a,r,o,l,i,r.treemapLevel,c,s)}function Cn(e,t,n,a,r,o,l,i,s,c,u,h=500,p=!0){const g=e.parent,m=l.transition("main transition").duration(h).ease(d.easeCubicOut);n.each(e=>e.target=e.mapLevel[s]),dn(e)||Tn(n,u),n.transition(m).tween("data",e=>{const t=d.interpolate(e.current,e.target);return n=>e.current=t(n)}).styleTween("opacity",e=>()=>e.current.opacity).attrTween("pointer-events",e=>()=>e.target.visible?"all":"none"),t.transition(m).filter(e=>e.target.visible).styleTween("x",e=>()=>"".concat(e.current.x0,"px")).styleTween("y",e=>()=>"".concat(e.current.y0,"px")).styleTween("width",e=>()=>"".concat(e.current.x1-e.current.x0,"px")).styleTween("height",e=>()=>"".concat(e.current.y1-e.current.y0,"px")),a.transition(m).filter(e=>e.target.visible).attrTween("x",e=>()=>e.current.x0+Hn(e.current)/2).attrTween("y",e=>()=>e.current.y0+In(e.current)/2).end().catch(()=>Rn(n)).then(()=>{dn(e)||(gn(f),xn(f),async function(e,t,n=400){const a=t.transition("text fade transition").duration(n).ease(d.easeCubicOut);await e.transition(a).filter(e=>e.target.visible).tween("data",(e,t,n)=>{const a=n[t],r=d.interpolate(Mn(e),En(a));return t=>e.current.opacity=r(t)}).styleTween("opacity",e=>()=>e.current.opacity).end().catch(e=>console.error("Exception in text fade transition",e)).then(()=>e.each((e,t,n)=>fn(n[t])))}(a,l,h),p&&Pn(n,s),Rn(n,u,g))}).catch(e=>{console.error("Exception completing promises after main transition",e),Rn(n,u,g)}),dn(e)?pn(n):(a.each((e,t,n)=>mn(n[t])),hn(n,s,c));const f=bn(n);g?u.hide(!1).text(e.data.name).onClick(()=>Nn(g,t,n,a,r,o,l,i,u))():u.hide(!0)()}const Mn=e=>e.target.textLockedAt.opacity,En=e=>yn[d.select(e).attr("class")],Tn=(e,t)=>{t.deactivate(!0),e.each((e,t,n)=>{d.select(n[t]).selectAll("rect").attr("pointer-events","none")})},Rn=(e,t)=>{t&&t.deactivate(!1),e.each((e,t,n)=>{d.select(n[t]).selectAll("rect").attr("pointer-events",null)})};var Dn=n(18),Ln=n.n(Dn);const Bn="leafnode",qn="branchnode",Fn="rootnode",Hn=e=>e.x1-e.x0,In=e=>e.y1-e.y0,Wn=(e,t)=>0===t.depth?Fn:((e,t)=>t.depth===e)(e,t)?Bn:qn;function Un(){let e=null,t=null,n=null,a=null,r=null;const o=o=>{r=function(e){let t=null,n=null,a=!0,r=!1;const o=U(e,".parent-controls",()=>e.append("div").attr("class","parent-controls").style("display",a?"none":"").html(Ln.a)),l=()=>{o.style("display",a?"none":"").select("#goto-parent").style("pointer-events",r?"none":null).html("\u21ea ".concat(n)).on("click",()=>t())};return l.deactivate=(...e)=>{if(!e.length)return r;r=e[0];const t=o.select("#goto-parent");return r?t.style("pointer-events","none"):t.style("pointer-events",null),l},l.hide=(...e)=>e.length?(a=e[0],l):a,l.text=(...e)=>e.length?(n=e[0],l):n,l.onClick=(...e)=>e.length?(t=e[0],l):t,l}(a),r();const l=t.height;e.treemapLevel||(e.treemapLevel=0),e.treemapRoute||(e.treemapRoute=[]),Sn(a.node().getBoundingClientRect().width,a.node().getBoundingClientRect().height)(t);const i=o.selectAll("g").data(t.descendants()),s=i.enter().append("g");s.append("rect"),s.append("text");const c=s.merge(i).sort((e,t)=>t.depth-e.depth),u=c.select("rect").attr("class",e=>"treerect ".concat(Wn(l,e))).style("x",e=>e.x0).style("y",e=>e.y0).style("width",e=>Hn(e)).style("height",e=>In(e));n&&u.style("fill",e=>n(e.data.color));const d=c.filter(e=>0!==e.value).select("text").attr("x",e=>e.x0+Hn(e)/2).attr("y",e=>e.y0+In(e)/2).text(e=>e.data.name),h=u.filter(e=>""===e.crossValue).datum();!function(e,t){e.each(e=>{e.mapLevel=[],e.mapLevel[0]={x0:e.x0,x1:Hn(e)+e.x0,y0:e.y0,y1:In(e)+e.y0,visible:!0,opacity:1}}),t.mapLevel[0].levelRoot=!0,An(e,0)}(c,h),hn(c,0,[]),xn(bn(c)),Pn(c,0),0===e.treemapRoute.length&&e.treemapRoute.push(h.crossValue),u.filter(e=>e.children).on("click",t=>Nn(t,u,c,d,e,a,o,h,r)),function(e,t,n,a,r,o,l,i){if(a.treemapLevel>0){const s=l.crossValue.split("|");Cn(l,e,t,n,a,r,o,l,0,s,i,1,!1),a.treemapRoute.slice(1,a.treemapRoute.length).forEach(s=>{const c=t.filter(e=>e.crossValue===s).datum(),u=c.crossValue.split("|");zn(c,u,t,c.depth,l,r),Cn(c,e,t,n,a,r,o,l,c.depth,u,i,1,!1)})}}(u,c,d,e,a,o,h,r)};return o.settings=(...t)=>t.length?(e=t[0],o):e,o.data=(...e)=>e.length?(t=e[0],o):t,o.color=(...e)=>e.length?(n=e[0],o):n,o.container=(...e)=>e.length?(a=e[0],o):a,o}function Kn(e,t){if(0===t.crossValues.length)return void console.warn("Unable to render a chart in the absence of any groups.");t.treemaps||(t.treemaps={});const n=Xt(t),a=un(t,n.map(e=>e.data)),r=ln().elementsPrefix("treemap");if(e.datum(n).call(r),a){const t=Lt().scale(a);e.call(t)}const o=r.chartEnter(),l=r.chartDiv();r.chartTitle().each((e,t,n)=>d.select(n[t]).text(e.split)),o.merge(l).select("svg").select("g.treemap").each((function({split:e,data:n}){const r=d.select(this);t.treemaps[e]||(t.treemaps[e]={}),Un().settings(t.treemaps[e]).data(n).container(d.select(d.select(this.parentNode).node().parentNode)).color(a)(r),oe().settings(t).centered(!0)(r.selectAll("g"))}))}Kn.plugin={type:"d3_treemap",name:"Treemap",max_cells:5e3,max_columns:50,initial:{type:"number",count:1,names:["Size","Color","Tooltip"]}};var Yn=[ht,Ot,kt,Pt,Mt,qt,Ht,Yt,Gt,cn,Kn],Jn=(n(24),n(25),n(19)),Gn=n.n(Jn),Xn=n(20),$n=n.n(Xn),Qn=n(21);function Zn(){const e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["--d3fc-gridline--color"]);return Zn=function(){return e},e}const ea=e=>d.color(e).opacity,ta=(e,t)=>{const n=d.color("#".concat(e));return n.opacity=t,n+""},na=e=>{if(window.ShadyCSS)return t=>window.ShadyCSS.getComputedStyleValue(e,t);{const t=getComputedStyle(e);return e=>t.getPropertyValue(e)}},aa=(e,t)=>{const n=Qn.parse(e)[0].colorStops;return n.map((e,a)=>[e.length?e.length.value/100:a/(n.length-1),ta(e.value,t)]).sort((e,t)=>e[0]-t[0])};var ra,oa=n(22);function la(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ia(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?la(Object(n),!0).forEach((function(t){sa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ca(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(ca.prototype,HTMLElement.prototype),Object.setPrototypeOf(ca,HTMLElement);const ua="".concat(Gn.a).concat(function(){const e=document.querySelector("head").querySelectorAll("style"),t=[];return e.forEach(e=>{-1!==e.innerText.indexOf("d3fc-")&&t.push(e.innerText)}),t.join("")}());Object(oa.bindTemplate)($n.a,ua)(ra=class extends ca{constructor(){super(),this._chart=null,this._settings=null}connectedCallback(){console.log("connected callback"),this._container=this.shadowRoot.querySelector(".chart")}render(e,t){this._chart=e,this._settings=this._configureSettings(this._settings,t),((e,t)=>{if(!t.colorStyles){const n=["series"];for(let e=1;e<=10;e++)n.push("series-".concat(e));const a={scheme:[],gradient:{},interpolator:{},grid:{}},r=na(e);n.forEach((e,t)=>{a[e]=r("--d3fc-".concat(e)),t>0&&a.scheme.push(a[e])}),a.opacity=ea(a.series),a.grid.gridLineColor=r(Zn()),["full","positive","negative"].forEach(e=>{const t=r("--d3fc-".concat(e,"--gradient"));a.gradient[e]=aa(t,a.opacity)}),t.colorStyles=a}})(this._container,this._settings),(this._settings.data&&this._settings.data.length>0||e.plugin.type!==this._chart.plugin.type)&&this.remove(),this.draw(),window.navigator.userAgent.indexOf("Edge")>-1&&setTimeout(()=>this.draw())}draw(){if(this._settings.data){const e=d.select(this._container),t="chart ".concat(this._chart.plugin.type);this._settings.size=this._container.getBoundingClientRect(),this._settings.data.length>0?this._chart(e.attr("class",t),this._settings):e.attr("class","".concat(t," disabled"))}}resize(){this.draw()}remove(){this._container.innerHTML=""}delete(){this.remove()}getContainer(){return this._container}getSettings(){const e=ia({},this._settings);return["crossValues","mainValues","splitValues","filter","data","size","colorStyles"].forEach(t=>{delete e[t]}),e}setSettings(e){this._settings=ia({},this._settings,{},e),this.draw()}_configureSettings(e,t){if(e){if(!e.data)return ia({},e,{},t);const r=[e.crossValues,e.mainValues,e.splitValues,e.realValues],o=[t.crossValues,t.mainValues,t.splitValues,t.realValues];if(n=r,a=o,JSON.stringify(n)===JSON.stringify(a))return ia({},e,{data:t.data,colorStyles:null})}var n,a;return this.remove(),t}});function da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?da(Object(n),!0).forEach((function(t){pa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ga=Symbol("D3FC chart"),ma={initial:{type:"number",count:1},selectMode:"select"};function fa(e){return async function(t,n,a,r,o){let l;const i=JSON.parse(this.getAttribute("columns"));l=r&&o?n.to_json({end_row:o,end_col:r,leaves_only:!0}):r?n.to_json({end_col:r,leaves_only:!0}):o?n.to_json({end_row:o,leaves_only:!0}):n.to_json({leaves_only:!0});let[s,c,u,d]=await Promise.all([this._table.schema(!1),n.schema(!1),l,n.get_config()]);if(a.cancelled)return;const{columns:h,row_pivots:p,column_pivots:g,filter:m}=d,f=(p.length>0?u.filter(e=>e.__ROW_PATH__&&e.__ROW_PATH__.length==p.length):u).map((e,t)=>p.length?e:ha({},e,{__ROW_PATH__:[t]}));let y={realValues:i,crossValues:p.map(e=>({name:e,type:s[e]})),mainValues:h.map(e=>({name:e,type:c[e]})),splitValues:g.map(e=>({name:e,type:s[e]})),filter:m,data:f};ba.call(this,t,e,y)}}function ya(){let e;return this[ga]=this[ga]||{},e=this[ga].chart?this[ga].chart:this[ga].chart=document.createElement("perspective-d3fc-chart"),e}function ba(e,t,n){const a=ya.call(this);document.body.contains(a)||(e.innerHTML="",e.appendChild(a)),a.render(t,n)}function xa(){if(this[ga]&&this[ga].chart){this[ga].chart.resize()}}function va(){if(this[ga]&&this[ga].chart){this[ga].chart.delete()}}function wa(){if(this[ga]&&this[ga].chart){return this[ga].chart.getSettings()}}function Oa(e){ya.call(this).setSettings(e)}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),function(...e){e=new Set(e.length>0?e:Yn.map(e=>e.plugin.type)),Yn.forEach(t=>{e.has(t.plugin.type)&&Object(i.registerPlugin)(t.plugin.type,ha({},ma,{},t.plugin,{create:fa(t),resize:xa,delete:va,save:wa,restore:Oa}))})}()}])}));
//# sourceMappingURL=perspective-viewer-d3fc.js.map