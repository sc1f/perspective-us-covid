{"version":3,"sources":["../../../src/js/api/view_api.js"],"names":["subscribe","unsubscribe","async_queue","bindall","view","worker","table_name","config","_worker","_name","Math","random","msg","cmd","view_name","post","proxy_view","name","prototype","get_config","to_json","to_arrow","to_columns","to_csv","schema","computed_schema","column_paths","num_columns","num_rows","set_depth","get_row_expanded","expand","collapse","delete","col_to_js_typed_array","on_update","remove_update","on_delete","remove_delete"],"mappings":"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","sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2019, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport {subscribe, unsubscribe, async_queue} from \"./dispatch.js\";\nimport {bindall} from \"../utils.js\";\n\n/**\n * Construct a proxy for the view object by creating a \"view\" message and\n * sending it through the worker.\n *\n * @param {*} worker\n * @param {*} table_name\n * @param {*} config\n */\nexport function view(worker, table_name, config) {\n    this._worker = worker;\n    //this._config = config;\n    this._name = Math.random() + \"\";\n    var msg = {\n        cmd: \"view\",\n        view_name: this._name,\n        table_name: table_name,\n        config: config\n    };\n    this._worker.post(msg);\n    bindall(this);\n}\n\n/**\n * Create a reference to a view located on `worker` for use by remote clients.\n *\n * @param {worker} worker the Web Worker at which the view is located.\n * @param {String} name a unique name for the view.\n */\nexport function proxy_view(worker, name) {\n    this._worker = worker;\n    this._name = name;\n}\n\nproxy_view.prototype = view.prototype;\n\n// Send view methods that do not create new objects (getters, setters etc.) to\n// the queue for processing.\n\nview.prototype.get_config = async_queue(\"get_config\");\n\nview.prototype.to_json = async_queue(\"to_json\");\n\nview.prototype.to_arrow = async_queue(\"to_arrow\");\n\nview.prototype.to_columns = async_queue(\"to_columns\");\n\nview.prototype.to_csv = async_queue(\"to_csv\");\n\nview.prototype.schema = async_queue(\"schema\");\n\nview.prototype.computed_schema = async_queue(\"computed_schema\");\n\nview.prototype.column_paths = async_queue(\"column_paths\");\n\nview.prototype.num_columns = async_queue(\"num_columns\");\n\nview.prototype.num_rows = async_queue(\"num_rows\");\n\nview.prototype.set_depth = async_queue(\"set_depth\");\n\nview.prototype.get_row_expanded = async_queue(\"get_row_expanded\");\n\nview.prototype.expand = async_queue(\"expand\");\n\nview.prototype.collapse = async_queue(\"collapse\");\n\nview.prototype.delete = async_queue(\"delete\");\n\nview.prototype.col_to_js_typed_array = async_queue(\"col_to_js_typed_array\");\n\nview.prototype.on_update = subscribe(\"on_update\", \"view_method\", true);\n\nview.prototype.remove_update = unsubscribe(\"remove_update\", \"view_method\", true);\n\nview.prototype.on_delete = subscribe(\"on_delete\", \"view_method\", true);\n\nview.prototype.remove_delete = unsubscribe(\"remove_delete\", \"view_method\", true);\n"],"file":"view_api.js"}