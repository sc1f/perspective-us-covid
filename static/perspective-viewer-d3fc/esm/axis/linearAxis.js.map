{"version":3,"sources":["../../../src/js/axis/linearAxis.js"],"names":["d3","fc","flattenArray","extentLinear","customExtent","valueformatter","scale","scaleLinear","domain","base","pad","padUnit","valueNames","_domain","data","accessors","map","v","d","parseFloat","getDataExtent","rebindAll","getMinimumGap","gaps","valueName","sort","a","b","filter","i","reduce","acc","src","Math","abs","min","dataWidth","args","length","labelFunction","tickFormatFunction"],"mappings":";;AAAA;;;;;;;;AAQA,OAAO,KAAKA,EAAZ,MAAoB,IAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,MAApB;AACA,SAAQC,YAAR,QAA2B,WAA3B;AACA,SAAQC,YAAY,IAAIC,YAAxB,QAA2C,6BAA3C;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AAEA,OAAO,MAAMC,KAAK,GAAG,MAAMN,EAAE,CAACO,WAAH,EAApB;AAEP,OAAO,MAAMC,MAAM,GAAG,MAAM;AACxB,QAAMC,IAAI,GAAGL,YAAY,GACpBM,GADQ,CACJ,CAAC,CAAD,EAAI,GAAJ,CADI,EAERC,OAFQ,CAEA,SAFA,CAAb;AAIA,MAAIC,UAAU,GAAG,CAAC,YAAD,CAAjB;;AAEA,QAAMC,OAAO,GAAGC,IAAI,IAAI;AACpBL,IAAAA,IAAI,CAACM,SAAL,CAAeH,UAAU,CAACI,GAAX,CAAeC,CAAC,IAAIC,CAAC,IAAIC,UAAU,CAACD,CAAC,CAACD,CAAD,CAAF,CAAnC,CAAf;AAEA,WAAOG,aAAa,CAAClB,YAAY,CAACY,IAAD,CAAb,CAApB;AACH,GAJD;;AAMAb,EAAAA,EAAE,CAACoB,SAAH,CAAaR,OAAb,EAAsBJ,IAAtB;;AAEA,QAAMa,aAAa,GAAGR,IAAI,IAAI;AAC1B,UAAMS,IAAI,GAAGX,UAAU,CAACI,GAAX,CAAeQ,SAAS,IACjCV,IAAI,CACCE,GADL,CACSE,CAAC,IAAIA,CAAC,CAACM,SAAD,CADf,EAEKC,IAFL,CAEU,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGC,CAFxB,EAGKC,MAHL,CAGY,CAACV,CAAD,EAAIW,CAAJ,EAAOH,CAAP,KAAaG,CAAC,KAAK,CAAN,IAAWX,CAAC,KAAKQ,CAAC,CAACG,CAAC,GAAG,CAAL,CAH3C,EAIKC,MAJL,CAIY,CAACC,GAAD,EAAMb,CAAN,EAASW,CAAT,EAAYG,GAAZ,KAAqBH,CAAC,KAAK,CAAN,IAAWE,GAAG,IAAIb,CAAC,GAAGc,GAAG,CAACH,CAAC,GAAG,CAAL,CAAzB,GAAmCE,GAAnC,GAAyCE,IAAI,CAACC,GAAL,CAAShB,CAAC,GAAGc,GAAG,CAACH,CAAC,GAAG,CAAL,CAAhB,CAJ1E,CADS,CAAb;AAQA,WAAOI,IAAI,CAACE,GAAL,CAAS,GAAGZ,IAAZ,CAAP;AACH,GAVD;;AAYA,QAAMH,aAAa,GAAGN,IAAI,IAAI;AAC1B,QAAIL,IAAI,CAACE,OAAL,MAAkB,QAAtB,EAAgC;AAC5B,YAAMyB,SAAS,GAAGd,aAAa,CAACR,IAAD,CAA/B;AACA,aAAOL,IAAI,CAACC,GAAL,CAAS,CAAC0B,SAAS,GAAG,CAAb,EAAgBA,SAAS,GAAG,CAA5B,CAAT,EAAyCtB,IAAzC,CAAP;AACH,KAHD,MAGO;AACH,aAAOL,IAAI,CAACK,IAAD,CAAX;AACH;AACJ,GAPD;;AASAD,EAAAA,OAAO,CAACW,SAAR,GAAoB,CAAC,GAAGa,IAAJ,KAAa;AAC7B,QAAI,CAACA,IAAI,CAACC,MAAV,EAAkB;AACd,aAAO1B,UAAU,CAAC,CAAD,CAAjB;AACH;;AACDA,IAAAA,UAAU,GAAG,CAACyB,IAAI,CAAC,CAAD,CAAL,CAAb;AACA,WAAOxB,OAAP;AACH,GAND;;AAOAA,EAAAA,OAAO,CAACD,UAAR,GAAqB,CAAC,GAAGyB,IAAJ,KAAa;AAC9B,QAAI,CAACA,IAAI,CAACC,MAAV,EAAkB;AACd,aAAO1B,UAAP;AACH;;AACDA,IAAAA,UAAU,GAAGyB,IAAI,CAAC,CAAD,CAAjB;AACA,WAAOxB,OAAP;AACH,GAND;;AAQA,SAAOA,OAAP;AACH,CApDM;AAsDP,OAAO,MAAM0B,aAAa,GAAGf,SAAS,IAAIN,CAAC,IAAIA,CAAC,CAACM,SAAD,CAAD,CAAa,CAAb,CAAxC;AAEP,OAAO,MAAMgB,kBAAkB,GAAGnC,cAA3B","sourcesContent":["/******************************************************************************\r\n *\r\n * Copyright (c) 2017, the Perspective Authors.\r\n *\r\n * This file is part of the Perspective library, distributed under the terms of\r\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\r\n *\r\n */\r\nimport * as d3 from \"d3\";\r\nimport * as fc from \"d3fc\";\r\nimport {flattenArray} from \"./flatten\";\r\nimport {extentLinear as customExtent} from \"../d3fc/extent/extentLinear\";\r\nimport valueformatter from \"./valueFormatter\";\r\n\r\nexport const scale = () => d3.scaleLinear();\r\n\r\nexport const domain = () => {\r\n    const base = customExtent()\r\n        .pad([0, 0.1])\r\n        .padUnit(\"percent\");\r\n\r\n    let valueNames = [\"crossValue\"];\r\n\r\n    const _domain = data => {\r\n        base.accessors(valueNames.map(v => d => parseFloat(d[v])));\r\n\r\n        return getDataExtent(flattenArray(data));\r\n    };\r\n\r\n    fc.rebindAll(_domain, base);\r\n\r\n    const getMinimumGap = data => {\r\n        const gaps = valueNames.map(valueName =>\r\n            data\r\n                .map(d => d[valueName])\r\n                .sort((a, b) => a - b)\r\n                .filter((d, i, a) => i === 0 || d !== a[i - 1])\r\n                .reduce((acc, d, i, src) => (i === 0 || acc <= d - src[i - 1] ? acc : Math.abs(d - src[i - 1])))\r\n        );\r\n\r\n        return Math.min(...gaps);\r\n    };\r\n\r\n    const getDataExtent = data => {\r\n        if (base.padUnit() == \"domain\") {\r\n            const dataWidth = getMinimumGap(data);\r\n            return base.pad([dataWidth / 2, dataWidth / 2])(data);\r\n        } else {\r\n            return base(data);\r\n        }\r\n    };\r\n\r\n    _domain.valueName = (...args) => {\r\n        if (!args.length) {\r\n            return valueNames[0];\r\n        }\r\n        valueNames = [args[0]];\r\n        return _domain;\r\n    };\r\n    _domain.valueNames = (...args) => {\r\n        if (!args.length) {\r\n            return valueNames;\r\n        }\r\n        valueNames = args[0];\r\n        return _domain;\r\n    };\r\n\r\n    return _domain;\r\n};\r\n\r\nexport const labelFunction = valueName => d => d[valueName][0];\r\n\r\nexport const tickFormatFunction = valueformatter;\r\n"],"file":"linearAxis.js"}