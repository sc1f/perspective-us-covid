{"version":3,"sources":["../../../src/js/tooltip/selectionEvent.js"],"names":["getGroupValues","getSplitValues","getDataValues","mapToFilter","d","name","value","raiseEvent","node","data","settings","column_names","map","groupFilters","splitFilters","filters","filter","concat","dispatchEvent","CustomEvent","bubbles","composed","detail","config","row","selectionEvent","_event","selection","on","args","length"],"mappings":"AAAA;;;;;;;;AAQA,SAAQA,cAAR,EAAwBC,cAAxB,EAAwCC,aAAxC,QAA4D,iBAA5D;;AAEA,MAAMC,WAAW,GAAGC,CAAC,IAAI,CAACA,CAAC,CAACC,IAAH,EAAS,IAAT,EAAeD,CAAC,CAACE,KAAjB,CAAzB;;AAEA,OAAO,MAAMC,UAAU,GAAG,CAACC,IAAD,EAAOC,IAAP,EAAaC,QAAb,KAA0B;AAChD,QAAMC,YAAY,GAAGT,aAAa,CAACO,IAAD,EAAOC,QAAP,CAAb,CAA8BE,GAA9B,CAAkCR,CAAC,IAAIA,CAAC,CAACC,IAAzC,CAArB;AACA,QAAMQ,YAAY,GAAGb,cAAc,CAACS,IAAD,EAAOC,QAAP,CAAd,CAA+BE,GAA/B,CAAmCT,WAAnC,CAArB;AACA,QAAMW,YAAY,GAAGb,cAAc,CAACQ,IAAD,EAAOC,QAAP,CAAd,CAA+BE,GAA/B,CAAmCT,WAAnC,CAArB;AAEA,QAAMY,OAAO,GAAGL,QAAQ,CAACM,MAAT,CAAgBC,MAAhB,CAAuBJ,YAAvB,EAAqCI,MAArC,CAA4CH,YAA5C,CAAhB;AAEAN,EAAAA,IAAI,CAACU,aAAL,CACI,IAAIC,WAAJ,CAAgB,mBAAhB,EAAqC;AACjCC,IAAAA,OAAO,EAAE,IADwB;AAEjCC,IAAAA,QAAQ,EAAE,IAFuB;AAGjCC,IAAAA,MAAM,EAAE;AACJX,MAAAA,YADI;AAEJY,MAAAA,MAAM,EAAE;AAACR,QAAAA;AAAD,OAFJ;AAGJS,MAAAA,GAAG,EAAEf,IAAI,CAACe;AAHN;AAHyB,GAArC,CADJ;AAWH,CAlBM;AAoBP,OAAO,MAAMC,cAAc,GAAG,MAAM;AAChC,MAAIf,QAAQ,GAAG,IAAf;;AAEA,QAAMgB,MAAM,GAAGC,SAAS,IAAI;AACxB,UAAMnB,IAAI,GAAGmB,SAAS,CAACnB,IAAV,EAAb;AACAmB,IAAAA,SAAS,CAACC,EAAV,CAAa,OAAb,EAAsBnB,IAAI,IAAIF,UAAU,CAACC,IAAD,EAAOC,IAAP,EAAaC,QAAb,CAAxC;AACH,GAHD;;AAKAgB,EAAAA,MAAM,CAAChB,QAAP,GAAkB,CAAC,GAAGmB,IAAJ,KAAa;AAC3B,QAAI,CAACA,IAAI,CAACC,MAAV,EAAkB;AACd,aAAOpB,QAAP;AACH;;AACDA,IAAAA,QAAQ,GAAGmB,IAAI,CAAC,CAAD,CAAf;AACA,WAAOH,MAAP;AACH,GAND;;AAQA,SAAOA,MAAP;AACH,CAjBM","sourcesContent":["/******************************************************************************\r\n *\r\n * Copyright (c) 2017, the Perspective Authors.\r\n *\r\n * This file is part of the Perspective library, distributed under the terms of\r\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\r\n *\r\n */\r\nimport {getGroupValues, getSplitValues, getDataValues} from \"./selectionData\";\r\n\r\nconst mapToFilter = d => [d.name, \"==\", d.value];\r\n\r\nexport const raiseEvent = (node, data, settings) => {\r\n    const column_names = getDataValues(data, settings).map(d => d.name);\r\n    const groupFilters = getGroupValues(data, settings).map(mapToFilter);\r\n    const splitFilters = getSplitValues(data, settings).map(mapToFilter);\r\n\r\n    const filters = settings.filter.concat(groupFilters).concat(splitFilters);\r\n\r\n    node.dispatchEvent(\r\n        new CustomEvent(\"perspective-click\", {\r\n            bubbles: true,\r\n            composed: true,\r\n            detail: {\r\n                column_names,\r\n                config: {filters},\r\n                row: data.row\r\n            }\r\n        })\r\n    );\r\n};\r\n\r\nexport const selectionEvent = () => {\r\n    let settings = null;\r\n\r\n    const _event = selection => {\r\n        const node = selection.node();\r\n        selection.on(\"click\", data => raiseEvent(node, data, settings));\r\n    };\r\n\r\n    _event.settings = (...args) => {\r\n        if (!args.length) {\r\n            return settings;\r\n        }\r\n        settings = args[0];\r\n        return _event;\r\n    };\r\n\r\n    return _event;\r\n};\r\n"],"file":"selectionEvent.js"}