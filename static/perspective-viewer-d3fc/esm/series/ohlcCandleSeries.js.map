{"version":3,"sources":["../../../src/js/series/ohlcCandleSeries.js"],"names":["fc","colorScale","setOpacity","isUp","d","closeValue","openValue","ohlcCandleSeries","settings","seriesCanvas","upColor","domain","downColor","defaultColors","colorStyles","mapFunction","avgColor","series","crossValue","highValue","lowValue","decorate","context","color","key","fillStyle","strokeStyle","bollingerAverageSeries","seriesCanvasLine","mainValue","bollinger","average","bollingerAreaSeries","seriesCanvasArea","upper","baseValue","lower","seriesCanvasMulti"],"mappings":"AAAA;;;;;;;;AAQA,OAAO,KAAKA,EAAZ,MAAoB,MAApB;AACA,SAAQC,UAAR,EAAoBC,UAApB,QAAqC,wBAArC;;AAEA,MAAMC,IAAI,GAAGC,CAAC,IAAIA,CAAC,CAACC,UAAF,IAAgBD,CAAC,CAACE,SAApC;;AAEA,OAAO,SAASC,gBAAT,CAA0BC,QAA1B,EAAoCC,YAApC,EAAkDC,OAAlD,EAA2D;AAC9D,QAAMC,MAAM,GAAGD,OAAO,CAACC,MAAR,EAAf;AACA,QAAMC,SAAS,GAAGX,UAAU,GACvBU,MADa,CACNA,MADM,EAEbH,QAFa,CAEJA,QAFI,EAGbK,aAHa,CAGC,CAACL,QAAQ,CAACM,WAAT,CAAqB,UAArB,CAAD,CAHD,EAIbC,WAJa,CAIDb,UAAU,CAAC,GAAD,CAJT,GAAlB;AAKA,QAAMc,QAAQ,GAAGf,UAAU,GACtBO,QADY,CACHA,QADG,EAEZG,MAFY,CAELA,MAFK,GAAjB;AAIA,QAAMM,MAAM,GAAGR,YAAY,GACtBS,UADU,CACCd,CAAC,IAAIA,CAAC,CAACc,UADR,EAEVZ,SAFU,CAEAF,CAAC,IAAIA,CAAC,CAACE,SAFP,EAGVa,SAHU,CAGAf,CAAC,IAAIA,CAAC,CAACe,SAHP,EAIVC,QAJU,CAIDhB,CAAC,IAAIA,CAAC,CAACgB,QAJN,EAKVf,UALU,CAKCD,CAAC,IAAIA,CAAC,CAACC,UALR,EAMVgB,QANU,CAMD,CAACC,OAAD,EAAUlB,CAAV,KAAgB;AACtB,UAAMmB,KAAK,GAAGpB,IAAI,CAACC,CAAD,CAAJ,GAAUM,OAAO,CAACN,CAAC,CAACoB,GAAH,CAAjB,GAA2BZ,SAAS,CAACR,CAAC,CAACoB,GAAH,CAAlD;AACAF,IAAAA,OAAO,CAACG,SAAR,GAAoBF,KAApB;AACAD,IAAAA,OAAO,CAACI,WAAR,GAAsBH,KAAtB;AACH,GAVU,CAAf;AAYA,QAAMI,sBAAsB,GAAG3B,EAAE,CAC5B4B,gBAD0B,GAE1BC,SAF0B,CAEhBzB,CAAC,IAAIA,CAAC,CAAC0B,SAAF,CAAYC,OAFD,EAG1Bb,UAH0B,CAGfd,CAAC,IAAIA,CAAC,CAACc,UAHQ,EAI1BG,QAJ0B,CAIjB,CAACC,OAAD,EAAUlB,CAAV,KAAgB;AACtBkB,IAAAA,OAAO,CAACI,WAAR,GAAsBV,QAAQ,CAACZ,CAAC,CAAC,CAAD,CAAD,CAAKoB,GAAN,CAA9B;AACH,GAN0B,CAA/B;AAQA,QAAMQ,mBAAmB,GAAGhC,EAAE,CACzBiC,gBADuB,GAEvBJ,SAFuB,CAEbzB,CAAC,IAAIA,CAAC,CAAC0B,SAAF,CAAYI,KAFJ,EAGvBC,SAHuB,CAGb/B,CAAC,IAAIA,CAAC,CAAC0B,SAAF,CAAYM,KAHJ,EAIvBlB,UAJuB,CAIZd,CAAC,IAAIA,CAAC,CAACc,UAJK,EAKvBG,QALuB,CAKd,CAACC,OAAD,EAAUlB,CAAV,KAAgB;AACtBkB,IAAAA,OAAO,CAACG,SAAR,GAAoBvB,UAAU,CAAC,IAAD,CAAV,CAAiBc,QAAQ,CAACZ,CAAC,CAAC,CAAD,CAAD,CAAKoB,GAAN,CAAzB,CAApB;AACH,GAPuB,CAA5B;AASA,SAAOxB,EAAE,CAACqC,iBAAH,GAAuBpB,MAAvB,CAA8B,CAACe,mBAAD,EAAsBf,MAAtB,EAA8BU,sBAA9B,CAA9B,CAAP;AACH","sourcesContent":["/******************************************************************************\r\n *\r\n * Copyright (c) 2017, the Perspective Authors.\r\n *\r\n * This file is part of the Perspective library, distributed under the terms of\r\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\r\n *\r\n */\r\nimport * as fc from \"d3fc\";\r\nimport {colorScale, setOpacity} from \"../series/seriesColors\";\r\n\r\nconst isUp = d => d.closeValue >= d.openValue;\r\n\r\nexport function ohlcCandleSeries(settings, seriesCanvas, upColor) {\r\n    const domain = upColor.domain();\r\n    const downColor = colorScale()\r\n        .domain(domain)\r\n        .settings(settings)\r\n        .defaultColors([settings.colorStyles[\"series-2\"]])\r\n        .mapFunction(setOpacity(0.5))();\r\n    const avgColor = colorScale()\r\n        .settings(settings)\r\n        .domain(domain)();\r\n\r\n    const series = seriesCanvas()\r\n        .crossValue(d => d.crossValue)\r\n        .openValue(d => d.openValue)\r\n        .highValue(d => d.highValue)\r\n        .lowValue(d => d.lowValue)\r\n        .closeValue(d => d.closeValue)\r\n        .decorate((context, d) => {\r\n            const color = isUp(d) ? upColor(d.key) : downColor(d.key);\r\n            context.fillStyle = color;\r\n            context.strokeStyle = color;\r\n        });\r\n\r\n    const bollingerAverageSeries = fc\r\n        .seriesCanvasLine()\r\n        .mainValue(d => d.bollinger.average)\r\n        .crossValue(d => d.crossValue)\r\n        .decorate((context, d) => {\r\n            context.strokeStyle = avgColor(d[0].key);\r\n        });\r\n\r\n    const bollingerAreaSeries = fc\r\n        .seriesCanvasArea()\r\n        .mainValue(d => d.bollinger.upper)\r\n        .baseValue(d => d.bollinger.lower)\r\n        .crossValue(d => d.crossValue)\r\n        .decorate((context, d) => {\r\n            context.fillStyle = setOpacity(0.25)(avgColor(d[0].key));\r\n        });\r\n\r\n    return fc.seriesCanvasMulti().series([bollingerAreaSeries, series, bollingerAverageSeries]);\r\n}\r\n"],"file":"ohlcCandleSeries.js"}