{"version":3,"sources":["../../../../src/js/series/sunburst/sunburstClick.js"],"names":["interpolate","drawArc","arcVisible","labelVisible","labelTransform","clickHandler","data","g","parent","parentTitle","path","label","radius","split","settings","p","skipTransition","sunburstLevel","name","datum","style","html","each","d","target","x0","Math","max","min","x1","PI","y0","depth","y1","t","transition","duration","tween","i","current","filter","getAttribute","attr","attrTween"],"mappings":"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","sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport {interpolate} from \"d3\";\nimport {drawArc, arcVisible} from \"./sunburstArc\";\nimport {labelVisible, labelTransform} from \"./sunburstLabel\";\n\nexport const clickHandler = (data, g, parent, parentTitle, path, label, radius, split, settings) => (p, skipTransition) => {\n    settings.sunburstLevel[split] = p.data.name;\n    if (p.parent) {\n        parent.datum(p.parent);\n        parent.style(\"cursor\", \"pointer\");\n        parentTitle.html(`&#8682; ${p.data.name}`);\n    } else {\n        parent.datum(data);\n        parent.style(\"cursor\", \"default\");\n        parentTitle.html(\"\");\n    }\n    data.each(\n        d =>\n            (d.target = {\n                x0: Math.max(0, Math.min(1, (d.x0 - p.x0) / (p.x1 - p.x0))) * 2 * Math.PI,\n                x1: Math.max(0, Math.min(1, (d.x1 - p.x0) / (p.x1 - p.x0))) * 2 * Math.PI,\n                y0: Math.max(0, d.y0 - p.depth),\n                y1: Math.max(0, d.y1 - p.depth)\n            })\n    );\n\n    const t = g.transition().duration(skipTransition ? 0 : 750);\n    path.transition(t)\n        .tween(\"data\", d => {\n            const i = interpolate(d.current, d.target);\n            return t => (d.current = i(t));\n        })\n        .filter(function(d) {\n            return +this.getAttribute(\"fill-opacity\") || arcVisible(d.target);\n        })\n        .attr(\"fill-opacity\", d => (arcVisible(d.target) ? 1 : 0))\n        .attr(\"user-select\", d => (arcVisible(d.target) ? \"initial\" : \"none\"))\n        .attr(\"pointer-events\", d => (arcVisible(d.target) ? \"initial\" : \"none\"))\n        .attrTween(\"d\", d => () => drawArc(radius)(d.current));\n\n    label\n        .filter(function(d) {\n            return +this.getAttribute(\"fill-opacity\") || labelVisible(d.target);\n        })\n        .transition(t)\n        .attr(\"fill-opacity\", d => +labelVisible(d.target))\n        .attrTween(\"transform\", d => () => labelTransform(d.current, radius));\n};\n"],"file":"sunburstClick.js"}