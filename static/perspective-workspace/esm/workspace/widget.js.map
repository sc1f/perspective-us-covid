{"version":3,"sources":["../../../src/js/workspace/widget.js"],"names":["Widget","PerspectiveViewerWidget","constructor","viewer","node","master","value","undefined","_master","classList","add","remove","toggleAttribute","removeAttribute","table","name","setAttribute","title","label","_name","linked","hasAttribute","toggleConfig","restore","config","viewerConfig","save","getAttribute","removeClass","onCloseRequest","msg","parentElement","removeChild","delete","onResize","notifyResize","isVisible"],"mappings":"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","sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2018, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport \"@finos/perspective-viewer\";\nimport {Widget} from \"@lumino/widgets\";\n\nexport class PerspectiveViewerWidget extends Widget {\n    constructor({viewer, node}) {\n        super({node});\n        this.viewer = viewer;\n        this.master = false;\n    }\n\n    set master(value) {\n        if (value !== undefined && this._master !== value) {\n            if (value) {\n                this.viewer.classList.add(\"workspace-master-widget\");\n                this.viewer.classList.remove(\"workspace-detail-widget\");\n\n                // TODO jsdom lacks `toggleAttribute` until 12.2.0\n                // https://github.com/jsdom/jsdom/blob/master/Changelog.md#1220\n                this.viewer.toggleAttribute?.(\"selectable\", true);\n            } else {\n                this.viewer.classList.add(\"workspace-detail-widget\");\n                this.viewer.classList.remove(\"workspace-master-widget\");\n                this.viewer.removeAttribute(\"selectable\");\n            }\n            this._master = value;\n        }\n    }\n\n    get master() {\n        return this._master;\n    }\n\n    get table() {\n        return this.viewer.table;\n    }\n\n    set name(value) {\n        if (value != null) {\n            this.viewer.setAttribute(\"name\", value);\n            this.title.label = value;\n            this._name = value;\n        }\n    }\n\n    get name() {\n        return this._name;\n    }\n\n    set linked(value) {\n        if (value !== undefined) {\n            if (value) {\n                this.viewer.setAttribute(\"linked\", \"\");\n            } else {\n                this.viewer.removeAttribute(\"linked\");\n            }\n        }\n    }\n    get linked() {\n        return this.viewer.hasAttribute(\"linked\");\n    }\n\n    toggleConfig() {\n        return this.viewer.toggleConfig();\n    }\n\n    restore(config) {\n        const {master, table, linked, name, ...viewerConfig} = config;\n        this.master = master;\n        this.name = name;\n        if (table) {\n            this.viewer.setAttribute(\"table\", table);\n        }\n        this.linked = linked;\n\n        return this.viewer.restore({...viewerConfig});\n    }\n\n    save() {\n        return {\n            ...this.viewer.save(),\n            master: this.master,\n            name: this.viewer.getAttribute(\"name\"),\n            table: this.viewer.getAttribute(\"table\"),\n            linked: this.linked\n        };\n    }\n\n    removeClass(name) {\n        super.removeClass(name);\n        this.viewer && this.viewer.classList.remove(name);\n    }\n\n    async onCloseRequest(msg) {\n        super.onCloseRequest(msg);\n        if (this.viewer.parentElement) {\n            this.viewer.parentElement.removeChild(this.viewer);\n        }\n        await this.viewer.delete();\n    }\n\n    onResize(msg) {\n        this.notifyResize();\n        super.onResize(msg);\n    }\n\n    async notifyResize() {\n        if (this.isVisible) {\n            await this.viewer.notifyResize();\n        }\n    }\n}\n"],"file":"widget.js"}